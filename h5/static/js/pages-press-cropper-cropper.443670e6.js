(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-press-cropper-cropper"],{"19ee":function(e,t,n){"use strict";n.r(t);var i=n("b257"),r=n("6d68");for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("5c66");var s,a=n("921e"),h=Object(a["a"])(r["default"],i["b"],i["c"],!1,null,"4b68fbde",null,!1,i["a"],s);t["default"]=h.exports},"22b3":function(e,t,n){"use strict";n("dcd5"),Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"VueCropper",{enumerable:!0,get:function(){return i.VueCropper}}),t.default=void 0;var i=n("b4ab");t.default=i.VueCropper},"2a8e":function(e,t,n){"use strict";(function(e){n("dcd5");var i=n("de9e").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("2f34");var r=i(n("6d7c")),o=i(n("5246")),s=n("97f3"),a=i(n("19ee")),h=i(n("1512"));t.default={components:{PressCropper:a.default,PressButton:o.default,PressImage:h.default},data:function(){return{src:"",show:!1,isESport:!1,h5Option:{autoCrop:!0,autoCropWidth:"80%",autoCropHeight:"80%",canMove:!0,canMoveBox:!0,centerBox:!0,enlarge:2,fixedBox:!0,info:!1,infoTrue:!0,mode:"contain",outputSize:1,outputType:"jpg"},parsedImage:""}},mounted:function(){this.initH5Option()},methods:{initH5Option:function(){var e=1,t=window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth;this.h5Option=(0,r.default)((0,r.default)({},this.h5Option),{},{autoCropWidth:t,autoCropHeight:Math.floor(t*e),aspectRatio:e,mode:"".concat(t,"px auto"),outputType:"png",centerBox:!0})},selectImg:function(){var t=this;(0,s.chooseImageInH5)().then((function(n){t.src=n,t.h5Option.img=t.src,e.log("[src]",t.src),t.show=!0}))},beforeDraw:function(e,t){e.setFillStyle("yellow"),t.zoom=2},afterDraw:function(t,n){t.fillText("我是一行文字水印",20,20),e.log("当前画布大小：".concat(n.width,"*").concat(n.height))},cropped:function(t,n){e.log("[cropped]",t,n)},confirm:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.log("[confirm]",n),this.show=!1,this.parsedImage=n[0]},cancel:function(){this.show=!1}}}}).call(this,n("44fd")["default"])},"466f":function(e,t,n){"use strict";var i=n("fe1b"),r=n.n(i);r.a},"5c66":function(e,t,n){"use strict";var i=n("7856"),r=n.n(i);r.a},6791:function(e,t,n){"use strict";n("dcd5");var i=n("de9e").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("2f34"),n("1469");var r=i(n("6d7c")),o=n("22b3"),s=i(n("5246")),a=i(n("a6d4")),h=i(n("3147")),c=n("cc439");t.default={name:"PressCropper",options:{styleIsolation:"shared"},components:{PressPopupPlus:h.default,PressButton:s.default,ToolBar:a.default,VueCropper:o.VueCropper},props:(0,r.default)((0,r.default)({},c.CROPPER_PROPS),{},{show:{type:Boolean,default:!1},showTitle:{type:Boolean,default:!0},title:{type:String,default:"裁剪图片"},cancelButtonText:{type:String,default:""},confirmButtonText:{type:String,default:""},toolbarClass:{type:String,default:""},isESport:{type:Boolean,default:!1},h5Option:{type:Object,default:function(){return{}}},delayShow:{type:Number,default:200}}),data:function(){return{showCropper:!1,timer:null,lastCropped:{}}},watch:{show:{handler:function(e){var t=this;e?(clearTimeout(this.timer),this.timer=setTimeout((function(){t.showCropper=!0}),this.delayShow)):(clearTimeout(this.timer),this.timer=setTimeout((function(){t.showCropper=!1}),300))},immediate:!0}},mounted:function(){},methods:{afterDraw:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.$emit.apply(this,["afterDraw"].concat(t))},beforeDraw:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.$emit.apply(this,["beforeDraw"].concat(t))},cropped:function(e,t){this.$emit("cropped",e,t),this.lastCropped={imagePath:e,imageInfo:t}},onClose:function(){this.$emit("close")},confirm:function(){var e=this;this.$refs.cropper.getCropData((function(t){e.$emit("confirm",t)}))},cancel:function(){this.$emit("cancel")}}}},"6d68":function(e,t,n){"use strict";n.r(t);var i=n("6791"),r=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=r.a},"6f83":function(e,t,n){var i=n("a8d8");t=i(!1),t.push([e.i,".press-cropper[data-v-4b68fbde]  .press-popup{width:100%!important}.press-cropper[data-v-4b68fbde]  .press-picker__toolbar{height:40px;line-height:40px;border-bottom:1px solid #ddd}.press-cropper[data-v-4b68fbde]  .press-picker__title{font-size:14px}.press-cropper__popup[data-v-4b68fbde]{width:100%}.press-cropper__popup[data-v-4b68fbde]  .press-popup{width:100%}.press-cropper__wrap[data-v-4b68fbde]{width:100%;height:400px}.press-cropper__footer[data-v-4b68fbde]{display:flex;align-items:center;justify-content:space-between;padding:0 40px;margin:10px}[data-v-4b68fbde] .press-cropper__confirm,[data-v-4b68fbde] .press-cropper__cancel{width:100px;height:30px;border-radius:0;font-size:14px}",""]),e.exports=t},7856:function(e,t,n){var i=n("6f83");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var r=n("5a15").default;r("10313e82",i,!0,{sourceMap:!1,shadowMode:!1})},"970e":function(e,t,n){"use strict";n.r(t);var i=n("2a8e"),r=n.n(i);for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);t["default"]=r.a},"97f3":function(e,t,n){"use strict";n("dcd5");var i=n("de9e").default;Object.defineProperty(t,"__esModule",{value:!0}),t.chooseImageInH5=o;var r=i(n("3eee"));function o(){return new Promise((function(e){var t=document.createElement("input");t.style.visibility="hidden",t.type="file",t.accept="image/*",t.style.height="100%",t.style.width="100%",t.id="inputfile",document.body.appendChild(t),t.onchange=function(n){var i=n.target.files[0];s(i,t).then((function(t){e(t)}))},t.click()}))}function s(e){return new Promise((function(t){var n=new FileReader;n.onload=function(e){var n;n="object"===(0,r.default)(e.target.result)?window.URL.createObjectURL(new Blob([e.target.result])):e.target.result,t(n)},n.readAsArrayBuffer(e)}))}n("7e35"),n("6d5e"),n("0d3d"),n("11e5"),n("c830"),n("4490"),n("95bf"),n("c1d3"),n("4766")},adb3:function(e,t,n){var i=n("a8d8");t=i(!1),t.push([e.i,".demo-wrap[data-v-7e8a3451]{padding:20px 20px}",""]),e.exports=t},b257:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("PressPopupPlus",{attrs:{show:e.show,"wrap-class":"press-cropper","custom-class":"press-cropper__popup"},on:{close:function(t){arguments[0]=t=e.$handleEvent(t),e.onClose.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)},cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel.apply(void 0,arguments)}}},[e.showTitle?n("ToolBar",{attrs:{title:e.title,"show-toolbar":!0,"cancel-button-text":e.cancelButtonText,"confirm-button-text":e.confirmButtonText,"custom-class":e.toolbarClass}}):e._e(),n("div",{staticClass:"press-cropper__wrap"},[n("VueCropper",e._b({ref:"cropper"},"VueCropper",e.h5Option,!1))],1),n("div",{staticClass:"press-cropper__footer"},[n("PressButton",{staticClass:"press-cropper__button",attrs:{"custom-class":"press-cropper__cancel",type:e.isESport?"e-sport-border":"default",size:"small"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel.apply(void 0,arguments)}}},[e._v("取消")]),n("PressButton",{staticClass:"press-cropper__button",attrs:{"custom-class":"press-cropper__confirm",type:e.isESport?"e-sport-primary":"primary",size:"small"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)}}},[e._v("确认")])],1)],1)},o=[]},b4ab:function(e,t,n){!function(t,n){e.exports=n()}(self,()=>(()=>{"use strict";var e={750:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(354),r=n.n(i),o=n(314),s=n.n(o),a=n(417),h=n.n(a),c=new URL(n(107),n.b),p=s()(r()),l=h()(c);p.push([e.id,`\n.vue-cropper[data-v-01ee97ad] {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  user-select: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  direction: ltr;\n  touch-action: none;\n  text-align: left;\n  background-image: url(${l});\n}\n.cropper-box[data-v-01ee97ad],\n.cropper-box-canvas[data-v-01ee97ad],\n.cropper-drag-box[data-v-01ee97ad],\n.cropper-crop-box[data-v-01ee97ad],\n.cropper-face[data-v-01ee97ad] {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  user-select: none;\n}\n.cropper-box-canvas img[data-v-01ee97ad] {\n  position: relative;\n  text-align: left;\n  user-select: none;\n  transform: none;\n  max-width: none;\n  max-height: none;\n}\n.cropper-box[data-v-01ee97ad] {\n  overflow: hidden;\n}\n.cropper-move[data-v-01ee97ad] {\n  cursor: move;\n}\n.cropper-crop[data-v-01ee97ad] {\n  cursor: crosshair;\n}\n.cropper-modal[data-v-01ee97ad] {\n  background: rgba(0, 0, 0, 0.5);\n}\n.cropper-crop-box[data-v-01ee97ad] {\n  /*border: 2px solid #39f;*/\n}\n.cropper-view-box[data-v-01ee97ad] {\n  display: block;\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  outline: 1px solid #39f;\n  outline-color: rgba(51, 153, 255, 0.75);\n  user-select: none;\n}\n.cropper-view-box img[data-v-01ee97ad] {\n  user-select: none;\n  text-align: left;\n  max-width: none;\n  max-height: none;\n}\n.cropper-face[data-v-01ee97ad] {\n  top: 0;\n  left: 0;\n  background-color: #fff;\n  opacity: 0.1;\n}\n.crop-info[data-v-01ee97ad] {\n  position: absolute;\n  left: 0px;\n  min-width: 65px;\n  text-align: center;\n  color: white;\n  line-height: 20px;\n  background-color: rgba(0, 0, 0, 0.8);\n  font-size: 12px;\n}\n.crop-line[data-v-01ee97ad] {\n  position: absolute;\n  display: block;\n  width: 100%;\n  height: 100%;\n  opacity: 0.1;\n}\n.line-w[data-v-01ee97ad] {\n  top: -3px;\n  left: 0;\n  height: 5px;\n  cursor: n-resize;\n}\n.line-a[data-v-01ee97ad] {\n  top: 0;\n  left: -3px;\n  width: 5px;\n  cursor: w-resize;\n}\n.line-s[data-v-01ee97ad] {\n  bottom: -3px;\n  left: 0;\n  height: 5px;\n  cursor: s-resize;\n}\n.line-d[data-v-01ee97ad] {\n  top: 0;\n  right: -3px;\n  width: 5px;\n  cursor: e-resize;\n}\n.crop-point[data-v-01ee97ad] {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  opacity: 0.75;\n  background-color: #39f;\n  border-radius: 100%;\n}\n.point1[data-v-01ee97ad] {\n  top: -4px;\n  left: -4px;\n  cursor: nw-resize;\n}\n.point2[data-v-01ee97ad] {\n  top: -5px;\n  left: 50%;\n  margin-left: -3px;\n  cursor: n-resize;\n}\n.point3[data-v-01ee97ad] {\n  top: -4px;\n  right: -4px;\n  cursor: ne-resize;\n}\n.point4[data-v-01ee97ad] {\n  top: 50%;\n  left: -4px;\n  margin-top: -3px;\n  cursor: w-resize;\n}\n.point5[data-v-01ee97ad] {\n  top: 50%;\n  right: -4px;\n  margin-top: -3px;\n  cursor: e-resize;\n}\n.point6[data-v-01ee97ad] {\n  bottom: -5px;\n  left: -4px;\n  cursor: sw-resize;\n}\n.point7[data-v-01ee97ad] {\n  bottom: -5px;\n  left: 50%;\n  margin-left: -3px;\n  cursor: s-resize;\n}\n.point8[data-v-01ee97ad] {\n  bottom: -5px;\n  right: -4px;\n  cursor: se-resize;\n}\n@media screen and (max-width: 500px) {\n.crop-point[data-v-01ee97ad] {\n    position: absolute;\n    width: 20px;\n    height: 20px;\n    opacity: 0.45;\n    background-color: #39f;\n    border-radius: 100%;\n}\n.point1[data-v-01ee97ad] {\n    top: -10px;\n    left: -10px;\n}\n.point2[data-v-01ee97ad],\n  .point4[data-v-01ee97ad],\n  .point5[data-v-01ee97ad],\n  .point7[data-v-01ee97ad] {\n    display: none;\n}\n.point3[data-v-01ee97ad] {\n    top: -10px;\n    right: -10px;\n}\n.point4[data-v-01ee97ad] {\n    top: 0;\n    left: 0;\n}\n.point6[data-v-01ee97ad] {\n    bottom: -10px;\n    left: -10px;\n}\n.point8[data-v-01ee97ad] {\n    bottom: -10px;\n    right: -10px;\n}\n}\n`,"",{version:3,sources:["webpack://./src/vue-cropper.vue"],names:[],mappings:";AA6+DA;EACA,kBAAA;EACA,WAAA;EACA,YAAA;EACA,sBAAA;EACA,iBAAA;EACA,yBAAA;EACA,sBAAA;EACA,qBAAA;EACA,cAAA;EACA,kBAAA;EACA,gBAAA;EACA,yDAAA;AACA;AAEA;;;;;EAKA,kBAAA;EACA,MAAA;EACA,QAAA;EACA,SAAA;EACA,OAAA;EACA,iBAAA;AACA;AAEA;EACA,kBAAA;EACA,gBAAA;EACA,iBAAA;EACA,eAAA;EACA,eAAA;EACA,gBAAA;AACA;AAEA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;AACA;AAEA;EACA,iBAAA;AACA;AAEA;EACA,8BAAA;AACA;AAEA;EACA,0BAAA;AACA;AAEA;EACA,cAAA;EACA,gBAAA;EACA,WAAA;EACA,YAAA;EACA,uBAAA;EACA,uCAAA;EACA,iBAAA;AACA;AAEA;EACA,iBAAA;EACA,gBAAA;EACA,eAAA;EACA,gBAAA;AACA;AAEA;EACA,MAAA;EACA,OAAA;EACA,sBAAA;EACA,YAAA;AACA;AAEA;EACA,kBAAA;EACA,SAAA;EACA,eAAA;EACA,kBAAA;EACA,YAAA;EACA,iBAAA;EACA,oCAAA;EACA,eAAA;AACA;AAEA;EACA,kBAAA;EACA,cAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;AACA;AAEA;EACA,SAAA;EACA,OAAA;EACA,WAAA;EACA,gBAAA;AACA;AAEA;EACA,MAAA;EACA,UAAA;EACA,UAAA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;EACA,OAAA;EACA,WAAA;EACA,gBAAA;AACA;AAEA;EACA,MAAA;EACA,WAAA;EACA,UAAA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,aAAA;EACA,sBAAA;EACA,mBAAA;AACA;AAEA;EACA,SAAA;EACA,UAAA;EACA,iBAAA;AACA;AAEA;EACA,SAAA;EACA,SAAA;EACA,iBAAA;EACA,gBAAA;AACA;AAEA;EACA,SAAA;EACA,WAAA;EACA,iBAAA;AACA;AAEA;EACA,QAAA;EACA,UAAA;EACA,gBAAA;EACA,gBAAA;AACA;AAEA;EACA,QAAA;EACA,WAAA;EACA,gBAAA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;EACA,UAAA;EACA,iBAAA;AACA;AAEA;EACA,YAAA;EACA,SAAA;EACA,iBAAA;EACA,gBAAA;AACA;AAEA;EACA,YAAA;EACA,WAAA;EACA,iBAAA;AACA;AAEA;AACA;IACA,kBAAA;IACA,WAAA;IACA,YAAA;IACA,aAAA;IACA,sBAAA;IACA,mBAAA;AACA;AAEA;IACA,UAAA;IACA,WAAA;AACA;AAEA;;;;IAIA,aAAA;AACA;AAEA;IACA,UAAA;IACA,YAAA;AACA;AAEA;IACA,MAAA;IACA,OAAA;AACA;AAEA;IACA,aAAA;IACA,WAAA;AACA;AAEA;IACA,aAAA;IACA,YAAA;AACA;AACA",sourcesContent:['<template>\n  <div class="vue-cropper" ref="cropper" @mouseover="scaleImg" @mouseout="cancelScale">\n    <div class="cropper-box" v-if="imgs">\n      <div\n        class="cropper-box-canvas"\n        v-show="!loading"\n        :style="{\n\t\t\t\t\t\'width\': trueWidth + \'px\',\n\t\t\t\t\t\'height\': trueHeight + \'px\',\n\t\t\t\t\t\'transform\': \'scale(\' + scale + \',\' + scale + \') \' + \'translate3d(\'+ x / scale + \'px,\' + y / scale + \'px,\' + \'0)\'\n\t\t\t\t\t+ \'rotateZ(\'+ rotate * 90 +\'deg)\'\n\t\t\t\t\t}"\n      >\n        <img :src="imgs" alt="cropper-img" ref="cropperImg">\n      </div>\n    </div>\n    <div\n      class="cropper-drag-box"\n      :class="{\'cropper-move\': move && !crop, \'cropper-crop\': crop, \'cropper-modal\': cropping}"\n      @mousedown="startMove"\n      @touchstart="startMove"\n    ></div>\n    <div\n      v-show="cropping"\n      class="cropper-crop-box"\n      :style="{\n\t\t\t\t\t\'width\': cropW + \'px\',\n\t\t\t\t\t\'height\': cropH + \'px\',\n\t\t\t\t\t\'transform\': \'translate3d(\'+ cropOffsertX + \'px,\' + cropOffsertY + \'px,\' + \'0)\'\n\t\t\t\t}"\n    >\n      <span class="cropper-view-box">\n        <img\n          :style="{\n\t\t\t\t\t\t\'width\': trueWidth + \'px\',\n\t\t\t\t\t\t\'height\': trueHeight + \'px\',\n\t\t\t\t\t\t\'transform\': \'scale(\' + scale + \',\' + scale + \') \' + \'translate3d(\'+ (x - cropOffsertX) / scale  + \'px,\' + (y - cropOffsertY) / scale + \'px,\' + \'0)\'\n\t\t\t\t\t\t+ \'rotateZ(\'+ rotate * 90 +\'deg)\'\n\t\t\t\t\t\t}"\n          :src="imgs"\n          alt="cropper-img"\n        >\n      </span>\n      <span class="cropper-face cropper-move" @mousedown="cropMove" @touchstart="cropMove"></span>\n      <span\n        class="crop-info"\n        v-if="info"\n        :style="{\'top\': cropInfo.top}"\n      >{{ cropInfo.width }} × {{ cropInfo.height }}</span>\n      <span v-if="!fixedBox">\n        <span\n          class="crop-line line-w"\n          @mousedown="changeCropSize($event, false, true, 0, 1)"\n          @touchstart="changeCropSize($event, false, true, 0, 1)"\n        ></span>\n        <span\n          class="crop-line line-a"\n          @mousedown="changeCropSize($event, true, false, 1, 0)"\n          @touchstart="changeCropSize($event, true, false, 1, 0)"\n        ></span>\n        <span\n          class="crop-line line-s"\n          @mousedown="changeCropSize($event, false, true, 0, 2)"\n          @touchstart="changeCropSize($event, false, true, 0, 2)"\n        ></span>\n        <span\n          class="crop-line line-d"\n          @mousedown="changeCropSize($event, true, false, 2, 0)"\n          @touchstart="changeCropSize($event, true, false, 2, 0)"\n        ></span>\n        <span\n          class="crop-point point1"\n          @mousedown="changeCropSize($event, true, true, 1, 1)"\n          @touchstart="changeCropSize($event, true, true, 1, 1)"\n        ></span>\n        <span\n          class="crop-point point2"\n          @mousedown="changeCropSize($event, false, true, 0, 1)"\n          @touchstart="changeCropSize($event, false, true, 0, 1)"\n        ></span>\n        <span\n          class="crop-point point3"\n          @mousedown="changeCropSize($event, true, true, 2, 1)"\n          @touchstart="changeCropSize($event, true, true, 2, 1)"\n        ></span>\n        <span\n          class="crop-point point4"\n          @mousedown="changeCropSize($event, true, false, 1, 0)"\n          @touchstart="changeCropSize($event, true, false, 1, 0)"\n        ></span>\n        <span\n          class="crop-point point5"\n          @mousedown="changeCropSize($event, true, false, 2, 0)"\n          @touchstart="changeCropSize($event, true, false, 2, 0)"\n        ></span>\n        <span\n          class="crop-point point6"\n          @mousedown="changeCropSize($event, true, true, 1, 2)"\n          @touchstart="changeCropSize($event, true, true, 1, 2)"\n        ></span>\n        <span\n          class="crop-point point7"\n          @mousedown="changeCropSize($event, false, true, 0, 2)"\n          @touchstart="changeCropSize($event, false, true, 0, 2)"\n        ></span>\n        <span\n          class="crop-point point8"\n          @mousedown="changeCropSize($event, true, true, 2, 2)"\n          @touchstart="changeCropSize($event, true, true, 2, 2)"\n        ></span>\n      </span>\n    </div>\n  </div>\n</template>\n\n<script>\nimport exifmin from "./exif-js-min";\n\nexport default {\n  data: function() {\n    return {\n      // 容器高宽\n      w: 0,\n      h: 0,\n      // 图片缩放比例\n      scale: 1,\n      // 图片偏移x轴\n      x: 0,\n      // 图片偏移y轴\n      y: 0,\n      // 图片加载\n      loading: true,\n      // 图片真实宽度\n      trueWidth: 0,\n      // 图片真实高度\n      trueHeight: 0,\n      move: true,\n      // 移动的x\n      moveX: 0,\n      // 移动的y\n      moveY: 0,\n      // 开启截图\n      crop: false,\n      // 正在截图\n      cropping: false,\n      // 裁剪框大小\n      cropW: 0,\n      cropH: 0,\n      cropOldW: 0,\n      cropOldH: 0,\n      // 判断是否能够改变\n      canChangeX: false,\n      canChangeY: false,\n      // 改变的基准点\n      changeCropTypeX: 1,\n      changeCropTypeY: 1,\n      // 裁剪框的坐标轴\n      cropX: 0,\n      cropY: 0,\n      cropChangeX: 0,\n      cropChangeY: 0,\n      cropOffsertX: 0,\n      cropOffsertY: 0,\n      // 支持的滚动事件\n      support: "",\n      // 移动端手指缩放\n      touches: [],\n      touchNow: false,\n      // 图片旋转\n      rotate: 0,\n      isIos: false,\n      orientation: 0,\n      imgs: "",\n      // 图片缩放系数\n      coe: 0.2,\n      // 是否正在多次缩放\n      scaling: false,\n      scalingSet: "",\n      coeStatus: "",\n      // 控制emit触发频率\n      isCanShow: true,\n      // 图片是否等于截图大小\n      imgIsQqualCrop: false\n    };\n  },\n  props: {\n    img: {\n      type: [String, Blob, null, File],\n      default: ""\n    },\n    // 输出图片压缩比\n    outputSize: {\n      type: Number,\n      default: 1\n    },\n    outputType: {\n      type: String,\n      default: "jpeg"\n    },\n    info: {\n      type: Boolean,\n      default: true\n    },\n    // 是否开启滚轮放大缩小\n    canScale: {\n      type: Boolean,\n      default: true\n    },\n    // 是否自成截图框\n    autoCrop: {\n      type: Boolean,\n      default: false\n    },\n    autoCropWidth: {\n      type: [Number, String],\n      default: 0\n    },\n    autoCropHeight: {\n      type: [Number, String],\n      default: 0\n    },\n    // 是否开启固定宽高比\n    fixed: {\n      type: Boolean,\n      default: false\n    },\n    // 宽高比 w/h\n    fixedNumber: {\n      type: Array,\n      default: () => {\n        return [1, 1];\n      }\n    },\n    // 固定大小 禁止改变截图框大小\n    fixedBox: {\n      type: Boolean,\n      default: false\n    },\n    // 输出截图是否缩放\n    full: {\n      type: Boolean,\n      default: false\n    },\n    // 是否可以拖动图片\n    canMove: {\n      type: Boolean,\n      default: true\n    },\n    // 是否可以拖动截图框\n    canMoveBox: {\n      type: Boolean,\n      default: true\n    },\n    // 上传图片按照原始比例显示\n    original: {\n      type: Boolean,\n      default: false\n    },\n    // 截图框能否超过图片\n    centerBox: {\n      type: Boolean,\n      default: false\n    },\n    // 是否根据dpr输出高清图片\n    high: {\n      type: Boolean,\n      default: true\n    },\n    // 截图框展示宽高类型\n    infoTrue: {\n      type: Boolean,\n      default: false\n    },\n    // 可以压缩图片宽高  默认不超过200\n    maxImgSize: {\n      type: [Number, String],\n      default: 2000\n    },\n    // 倍数  可渲染当前截图框的n倍 0 - 1000;\n    enlarge: {\n      type: [Number, String],\n      default: 1\n    },\n\n    // 自动预览的固定宽度\n    preW: {\n      type: [Number, String],\n      default: 0\n    },\n    /*\n      图片布局方式 mode 实现和css背景一样的效果\n      contain  居中布局 默认不会缩放 保证图片在容器里面 mode: \'contain\'\n      cover    拉伸布局 填充整个容器  mode: \'cover\'\n      如果仅有一个数值被给定，这个数值将作为宽度值大小，高度值将被设定为auto。 mode: \'50px\'\n      如果有两个数值被给定，第一个将作为宽度值大小，第二个作为高度值大小。 mode: \'50px 60px\'\n    */\n    mode: {\n      type: String,\n      default: "contain"\n    },\n    //限制最小区域,可传1以上的数字和字符串，限制长宽都是这么大\n    // 也可以传数组[90,90] \n    limitMinSize: {\n      type: [Number, Array, String],\n      default: () => {\n        return 10;\n      },\n      validator: function (value) {\n        if (Array.isArray(value)) {\n          return Number(value[0]) >= 0 && Number(value[1]) >= 0;\n        } else {\n          return Number(value) >= 0;\n        }\n      },\n    },\n    // 导出时,填充背景颜色\n    fillColor: {\n      type: String,\n      default: "",\n    },\n  },\n  computed: {\n    cropInfo() {\n      let obj = {};\n      obj.top = this.cropOffsertY > 21 ? "-21px" : "0px";\n      obj.width = this.cropW > 0 ? this.cropW : 0;\n      obj.height = this.cropH > 0 ? this.cropH : 0;\n      if (this.infoTrue) {\n        let dpr = 1;\n        if (this.high && !this.full) {\n          dpr = window.devicePixelRatio;\n        }\n        if ((this.enlarge !== 1) & !this.full) {\n          dpr = Math.abs(Number(this.enlarge));\n        }\n        obj.width = obj.width * dpr;\n        obj.height = obj.height * dpr;\n        if (this.full) {\n          obj.width = obj.width / this.scale;\n          obj.height = obj.height / this.scale;\n        }\n      }\n      obj.width = obj.width.toFixed(0);\n      obj.height = obj.height.toFixed(0);\n      return obj;\n    },\n\n    isIE() {\n      var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串\n      const isIE = !!window.ActiveXObject || \'ActiveXObject\' in window; //判断是否IE浏览器\n      return isIE;\n    },\n\n    passive () {\n      return this.isIE ? null : {\n        passive: false\n      }\n    }\n  },\n  watch: {\n    // 如果图片改变， 重新布局\n    img() {\n      // 当传入图片时, 读取图片信息同时展示\n      this.checkedImg();\n    },\n    imgs(val) {\n      if (val === "") {\n        return;\n      }\n      this.reload();\n    },\n    cropW() {\n      this.showPreview();\n    },\n    cropH() {\n      this.showPreview();\n    },\n    cropOffsertX() {\n      this.showPreview();\n    },\n    cropOffsertY() {\n      this.showPreview();\n    },\n    scale(val, oldVal) {\n      this.showPreview();\n    },\n    x() {\n      this.showPreview();\n    },\n    y() {\n      this.showPreview();\n    },\n    autoCrop(val) {\n      if (val) {\n        this.goAutoCrop();\n      }\n    },\n    // 修改了自动截图框\n    autoCropWidth() {\n      if (this.autoCrop) {\n        this.goAutoCrop();\n      }\n    },\n    autoCropHeight() {\n      if (this.autoCrop) {\n        this.goAutoCrop();\n      }\n    },\n    mode() {\n      this.checkedImg();\n    },\n    rotate() {\n      this.showPreview();\n      if (this.autoCrop) {\n        this.goAutoCrop(this.cropW, this.cropH);\n      } else {\n        if (this.cropW > 0 || this.cropH > 0) {\n          this.goAutoCrop(this.cropW, this.cropH);\n        }\n      }\n    }\n  },\n  methods: {\n    getVersion (name) {\n      var arr = navigator.userAgent.split(\' \'); \n      var chromeVersion = \'\';\n      let result = 0;\n      const reg = new RegExp(name, \'i\')\n      for(var i=0;i < arr.length;i++){\n          if(reg.test(arr[i]))\n          chromeVersion = arr[i]\n      }\n      if(chromeVersion){\n          result = chromeVersion.split(\'/\')[1].split(\'.\');\n      } else {\n          result = [\'0\', \'0\', \'0\'];\n      }\n      return result\n    },\n    checkOrientationImage(img, orientation, width, height) {\n      // 如果是 chrome内核版本在81 safari 在 605 以上不处理图片旋转\n      // alert(navigator.userAgent)\n      if (this.getVersion(\'chrome\')[0] >= 81) {\n        orientation = -1\n      } else {\n        if (this.getVersion(\'safari\')[0] >= 605 ) {\n          const safariVersion = this.getVersion(\'version\')\n          if (safariVersion[0] > 13 && safariVersion[1] > 1) {\n              orientation = -1\n          }\n        } else {\n          //  判断 ios 版本进行处理\n         // 针对 ios 版本大于 13.4的系统不做图片旋转\n         const isIos  = navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/)\n         if (isIos) {\n           let version = isIos[1]\n           version = version.split(\'_\')\n           if (version[0] > 13 ||  (version[0] >= 13 && version[1] >= 4)) {\n             orientation = -1\n           }\n         }\n        }\n      }\n      \n      // alert(`当前处理的orientation${orientation}`)\n      let canvas = document.createElement("canvas");\n      let ctx = canvas.getContext("2d");\n      ctx.save();\n      \n      switch (orientation) {\n        case 2:\n          canvas.width = width;\n          canvas.height = height;\n          // horizontal flip\n          ctx.translate(width, 0);\n          ctx.scale(-1, 1);\n          break;\n        case 3:\n          canvas.width = width;\n          canvas.height = height;\n          //180 graus\n          ctx.translate(width / 2, height / 2);\n          ctx.rotate((180 * Math.PI) / 180);\n          ctx.translate(-width / 2, -height / 2);\n          break;\n        case 4:\n          canvas.width = width;\n          canvas.height = height;\n          // vertical flip\n          ctx.translate(0, height);\n          ctx.scale(1, -1);\n          break;\n        case 5:\n          // vertical flip + 90 rotate right\n          canvas.height = width;\n          canvas.width = height;\n          ctx.rotate(0.5 * Math.PI);\n          ctx.scale(1, -1);\n          break;\n        case 6:\n          canvas.width = height;\n          canvas.height = width;\n          //90 graus\n          ctx.translate(height / 2, width / 2);\n          ctx.rotate((90 * Math.PI) / 180);\n          ctx.translate(-width / 2, -height / 2);\n          break;\n        case 7:\n          // horizontal flip + 90 rotate right\n          canvas.height = width;\n          canvas.width = height;\n          ctx.rotate(0.5 * Math.PI);\n          ctx.translate(width, -height);\n          ctx.scale(-1, 1);\n          break;\n        case 8:\n          canvas.height = width;\n          canvas.width = height;\n          //-90 graus\n          ctx.translate(height / 2, width / 2);\n          ctx.rotate((-90 * Math.PI) / 180);\n          ctx.translate(-width / 2, -height / 2);\n          break;\n        default:\n          canvas.width = width;\n          canvas.height = height;\n      }\n\n      ctx.drawImage(img, 0, 0, width, height);\n      ctx.restore();\n      canvas.toBlob(\n        blob => {\n          let data = URL.createObjectURL(blob);\n          URL.revokeObjectURL(this.imgs)\n          this.imgs = data;\n        },\n        "image/" + this.outputType,\n        1\n      );\n    },\n\n    // checkout img\n    checkedImg() {\n      if (this.img === null || this.img === \'\') {\n        this.imgs = \'\'\n        this.clearCrop()\n        return\n      }\n      this.loading = true;\n      this.scale = 1;\n      this.rotate = 0;\n      this.clearCrop();\n      let img = new Image();\n      img.onload = () => {\n        if (this.img === "") {\n          this.$emit("imgLoad", "error");\n          this.$emit("img-load", "error");\n          this.$emit("img-load", new Error(\'图片不能为空\'));\n          return false;\n        }\n\n        let width = img.width;\n        let height = img.height;\n        exifmin.getData(img).then(data => {\n          this.orientation = data.orientation || 1;\n          let max = Number(this.maxImgSize);\n          if (!this.orientation && (width < max) & (height < max)) {\n            this.imgs = this.img;\n            return;\n          }\n\n          if (width > max) {\n            height = (height / width) * max;\n            width = max;\n          }\n\n          if (height > max) {\n            width = (width / height) * max;\n            height = max;\n          }\n          this.checkOrientationImage(img, this.orientation, width, height);\n        }).catch(error => {\n          this.$emit("img-load", "error");\n          this.$emit("img-load-error", error);\n        });\n      };\n\n      img.onerror = () => {\n        this.$emit("imgLoad", "error");\n        this.$emit("img-load", "error");\n        this.$emit("img-load-error", error);\n      };\n\n      // 判断如果不是base64图片 再添加crossOrigin属性，否则会导致iOS低版本(10.2)无法显示图片\n      if (this.img.substr(0, 4) !== "data") {\n        img.crossOrigin = "";\n      }\n\n      if (this.isIE) {\n        var xhr = new XMLHttpRequest();\n        xhr.onload = function() {\n          var url = URL.createObjectURL(this.response);\n          img.src = url;\n        };\n        xhr.open("GET", this.img, true);\n        xhr.responseType = "blob";\n        xhr.send();\n      } else {\n        img.src = this.img;\n      }\n    },\n    // 当按下鼠标键\n    startMove(e) {\n      e.preventDefault();\n      // 如果move 为true 表示当前可以拖动\n      if (this.move && !this.crop) {\n        if (!this.canMove) {\n          return false;\n        }\n        // 开始移动\n        this.moveX = (\'clientX\' in e ? e.clientX : e.touches[0].clientX) - this.x;\n        this.moveY = (\'clientY\' in e ? e.clientY : e.touches[0].clientY) - this.y;\n        if (e.touches) {\n          window.addEventListener("touchmove", this.moveImg);\n          window.addEventListener("touchend", this.leaveImg);\n          if (e.touches.length == 2) {\n            // 记录手指刚刚放上去\n            this.touches = e.touches;\n            window.addEventListener("touchmove", this.touchScale);\n            window.addEventListener("touchend", this.cancelTouchScale);\n          }\n        } else {\n          window.addEventListener("mousemove", this.moveImg);\n          window.addEventListener("mouseup", this.leaveImg);\n        }\n        // 触发图片移动事件\n        this.$emit("imgMoving", {\n          moving: true,\n          axis: this.getImgAxis()\n        });\n        this.$emit("img-moving", {\n          moving: true,\n          axis: this.getImgAxis()\n        });\n      } else {\n        // 截图ing\n        this.cropping = true;\n        // 绑定截图事件\n        window.addEventListener("mousemove", this.createCrop);\n        window.addEventListener("mouseup", this.endCrop);\n        window.addEventListener("touchmove", this.createCrop);\n        window.addEventListener("touchend", this.endCrop);\n        this.cropOffsertX = e.offsetX\n          ? e.offsetX\n          : e.touches[0].pageX - this.$refs.cropper.offsetLeft;\n        this.cropOffsertY = e.offsetY\n          ? e.offsetY\n          : e.touches[0].pageY - this.$refs.cropper.offsetTop;\n        this.cropX = \'clientX\' in e ? e.clientX : e.touches[0].clientX;\n        this.cropY = \'clientY\' in e ? e.clientY : e.touches[0].clientY;\n        this.cropChangeX = this.cropOffsertX;\n        this.cropChangeY = this.cropOffsertY;\n        this.cropW = 0;\n        this.cropH = 0;\n      }\n    },\n\n    // 移动端缩放\n    touchScale(e) {\n      e.preventDefault();\n      let scale = this.scale;\n      // 记录变化量\n      // 第一根手指\n      var oldTouch1 = {\n        x: this.touches[0].clientX,\n        y: this.touches[0].clientY\n      };\n      var newTouch1 = {\n        x: e.touches[0].clientX,\n        y: e.touches[0].clientY\n      };\n      // 第二根手指\n      var oldTouch2 = {\n        x: this.touches[1].clientX,\n        y: this.touches[1].clientY\n      };\n      var newTouch2 = {\n        x: e.touches[1].clientX,\n        y: e.touches[1].clientY\n      };\n      var oldL = Math.sqrt(\n        Math.pow(oldTouch1.x - oldTouch2.x, 2) +\n          Math.pow(oldTouch1.y - oldTouch2.y, 2)\n      );\n      var newL = Math.sqrt(\n        Math.pow(newTouch1.x - newTouch2.x, 2) +\n          Math.pow(newTouch1.y - newTouch2.y, 2)\n      );\n      var cha = newL - oldL;\n      // 根据图片本身大小 决定每次改变大小的系数, 图片越大系数越小\n      // 1px - 0.2\n      var coe = 1;\n      coe =\n        coe / this.trueWidth > coe / this.trueHeight\n          ? coe / this.trueHeight\n          : coe / this.trueWidth;\n      coe = coe > 0.1 ? 0.1 : coe;\n      var num = coe * cha;\n      if (!this.touchNow) {\n        this.touchNow = true;\n        if (cha > 0) {\n          scale += Math.abs(num);\n        } else if (cha < 0) {\n          scale > Math.abs(num) ? (scale -= Math.abs(num)) : scale;\n        }\n        this.touches = e.touches;\n        setTimeout(() => {\n          this.touchNow = false;\n        }, 8);\n        if (!this.checkoutImgAxis(this.x, this.y, scale)) {\n          return false;\n        }\n        this.scale = scale;\n      }\n    },\n\n    cancelTouchScale(e) {\n      window.removeEventListener("touchmove", this.touchScale);\n    },\n\n    // 移动图片\n    moveImg(e) {\n      e.preventDefault();\n      if (e.touches && e.touches.length === 2) {\n        this.touches = e.touches;\n        window.addEventListener("touchmove", this.touchScale);\n        window.addEventListener("touchend", this.cancelTouchScale);\n        window.removeEventListener("touchmove", this.moveImg);\n        return false;\n      }\n      let nowX = \'clientX\' in e ? e.clientX : e.touches[0].clientX;\n      let nowY = \'clientY\' in e ? e.clientY : e.touches[0].clientY;\n\n      let changeX, changeY;\n      changeX = nowX - this.moveX;\n      changeY = nowY - this.moveY;\n\n      this.$nextTick(() => {\n        if (this.centerBox) {\n          let axis = this.getImgAxis(changeX, changeY, this.scale);\n          let cropAxis = this.getCropAxis();\n          let imgW = this.trueHeight * this.scale;\n          let imgH = this.trueWidth * this.scale;\n          let maxLeft, maxTop, maxRight, maxBottom;\n          switch (this.rotate) {\n            case 1:\n            case -1:\n            case 3:\n            case -3:\n              maxLeft =\n                this.cropOffsertX -\n                (this.trueWidth * (1 - this.scale)) / 2 +\n                (imgW - imgH) / 2;\n              maxTop =\n                this.cropOffsertY -\n                (this.trueHeight * (1 - this.scale)) / 2 +\n                (imgH - imgW) / 2;\n              maxRight = maxLeft - imgW + this.cropW;\n              maxBottom = maxTop - imgH + this.cropH;\n              break;\n            default:\n              maxLeft =\n                this.cropOffsertX - (this.trueWidth * (1 - this.scale)) / 2;\n              maxTop =\n                this.cropOffsertY - (this.trueHeight * (1 - this.scale)) / 2;\n              maxRight = maxLeft - imgH + this.cropW;\n              maxBottom = maxTop - imgW + this.cropH;\n              break;\n          }\n\n          // 图片左边 图片不能超过截图框\n          if (axis.x1 >= cropAxis.x1) {\n            changeX = maxLeft;\n          }\n\n          // 图片上边 图片不能超过截图框\n          if (axis.y1 >= cropAxis.y1) {\n            changeY = maxTop;\n          }\n\n          // 图片右边\n          if (axis.x2 <= cropAxis.x2) {\n            changeX = maxRight;\n          }\n\n          // 图片下边\n          if (axis.y2 <= cropAxis.y2) {\n            changeY = maxBottom;\n          }\n        }\n        this.x = changeX;\n        this.y = changeY;\n        // 触发图片移动事件\n        this.$emit("imgMoving", {\n          moving: true,\n          axis: this.getImgAxis()\n        });\n        this.$emit("img-moving", {\n          moving: true,\n          axis: this.getImgAxis()\n        });\n      });\n    },\n    // 移动图片结束\n    leaveImg(e) {\n      window.removeEventListener("mousemove", this.moveImg);\n      window.removeEventListener("touchmove", this.moveImg);\n      window.removeEventListener("mouseup", this.leaveImg);\n      window.removeEventListener("touchend", this.leaveImg);\n      // 触发图片移动事件\n      this.$emit("imgMoving", {\n        moving: false,\n        axis: this.getImgAxis()\n      });\n      this.$emit("img-moving", {\n        moving: false,\n        axis: this.getImgAxis()\n      });\n    },\n    // 缩放图片\n    scaleImg() {\n      if (this.canScale) {\n        window.addEventListener(this.support, this.changeSize, this.passive);\n      }\n    },\n    // 移出框\n    cancelScale() {\n      if (this.canScale) {\n        window.removeEventListener(this.support, this.changeSize);\n      }\n    },\n    // 改变大小函数\n    changeSize(e) {\n      e.preventDefault();\n      let scale = this.scale;\n      var change = e.deltaY || e.wheelDelta;\n      // 根据图片本身大小 决定每次改变大小的系数, 图片越大系数越小\n      var isFirefox = navigator.userAgent.indexOf("Firefox");\n      change = isFirefox > 0 ? change * 30 : change;\n      // 修复ie的滚动缩放\n      if (this.isIE) {\n        change = -change;\n      }\n      // 1px - 0.2\n      var coe = this.coe;\n      coe =\n        coe / this.trueWidth > coe / this.trueHeight\n          ? coe / this.trueHeight\n          : coe / this.trueWidth;\n      var num = coe * change;\n      num < 0\n        ? (scale += Math.abs(num))\n        : scale > Math.abs(num)\n        ? (scale -= Math.abs(num))\n        : scale;\n      // 延迟0.1s 每次放大大或者缩小的范围\n      let status = num < 0 ? "add" : "reduce";\n      if (status !== this.coeStatus) {\n        this.coeStatus = status;\n        this.coe = 0.2;\n      }\n      if (!this.scaling) {\n        this.scalingSet = setTimeout(() => {\n          this.scaling = false;\n          this.coe = this.coe += 0.01;\n        }, 50);\n      }\n      this.scaling = true;\n      if (!this.checkoutImgAxis(this.x, this.y, scale)) {\n        return false;\n      }\n      this.scale = scale;\n    },\n\n    // 修改图片大小函数\n    changeScale(num) {\n      let scale = this.scale;\n      num = num || 1;\n      var coe = 20;\n      coe =\n        coe / this.trueWidth > coe / this.trueHeight\n          ? coe / this.trueHeight\n          : coe / this.trueWidth;\n      num = num * coe;\n      num > 0\n        ? (scale += Math.abs(num))\n        : scale > Math.abs(num)\n        ? (scale -= Math.abs(num))\n        : scale;\n      if (!this.checkoutImgAxis(this.x, this.y, scale)) {\n        return false;\n      }\n      this.scale = scale;\n    },\n    // 创建截图框\n    createCrop(e) {\n      e.preventDefault();\n      // 移动生成大小\n      var nowX = \'clientX\' in e ? e.clientX : e.touches ? e.touches[0].clientX : 0;\n      var nowY = \'clientY\' in e ? e.clientY : e.touches ? e.touches[0].clientY : 0;\n      this.$nextTick(() => {\n        var fw = nowX - this.cropX;\n        var fh = nowY - this.cropY;\n        if (fw > 0) {\n          this.cropW =\n            fw + this.cropChangeX > this.w ? this.w - this.cropChangeX : fw;\n          this.cropOffsertX = this.cropChangeX;\n        } else {\n          this.cropW =\n            this.w - this.cropChangeX + Math.abs(fw) > this.w\n              ? this.cropChangeX\n              : Math.abs(fw);\n          this.cropOffsertX =\n            this.cropChangeX + fw > 0 ? this.cropChangeX + fw : 0;\n        }\n\n        if (!this.fixed) {\n          if (fh > 0) {\n            this.cropH =\n              fh + this.cropChangeY > this.h ? this.h - this.cropChangeY : fh;\n            this.cropOffsertY = this.cropChangeY;\n          } else {\n            this.cropH =\n              this.h - this.cropChangeY + Math.abs(fh) > this.h\n                ? this.cropChangeY\n                : Math.abs(fh);\n            this.cropOffsertY =\n              this.cropChangeY + fh > 0 ? this.cropChangeY + fh : 0;\n          }\n        } else {\n          var fixedHeight =\n            (this.cropW / this.fixedNumber[0]) * this.fixedNumber[1];\n          if (fixedHeight + this.cropOffsertY > this.h) {\n            this.cropH = this.h - this.cropOffsertY;\n            this.cropW =\n              (this.cropH / this.fixedNumber[1]) * this.fixedNumber[0];\n            if (fw > 0) {\n              this.cropOffsertX = this.cropChangeX;\n            } else {\n              this.cropOffsertX = this.cropChangeX - this.cropW;\n            }\n          } else {\n            this.cropH = fixedHeight;\n          }\n          this.cropOffsertY = this.cropOffsertY;\n        }\n      });\n    },\n\n    // 改变截图框大小\n    changeCropSize(e, w, h, typeW, typeH) {\n      e.preventDefault();\n      window.addEventListener("mousemove", this.changeCropNow);\n      window.addEventListener("mouseup", this.changeCropEnd);\n      window.addEventListener("touchmove", this.changeCropNow);\n      window.addEventListener("touchend", this.changeCropEnd);\n      this.canChangeX = w;\n      this.canChangeY = h;\n      this.changeCropTypeX = typeW;\n      this.changeCropTypeY = typeH;\n      this.cropX = \'clientX\' in e ? e.clientX : e.touches[0].clientX;\n      this.cropY = \'clientY\' in e ? e.clientY : e.touches[0].clientY;\n      this.cropOldW = this.cropW;\n      this.cropOldH = this.cropH;\n      this.cropChangeX = this.cropOffsertX;\n      this.cropChangeY = this.cropOffsertY;\n      if (this.fixed) {\n        if (this.canChangeX && this.canChangeY) {\n          this.canChangeY = 0;\n        }\n      }\n      this.$emit(\'changeCropSize\', {\n        width: this.cropW,\n        height: this.cropH\n      })\n      this.$emit(\'change-crop-size\', {\n        width: this.cropW,\n        height: this.cropH\n      })\n    },\n\n    // 正在改变\n    changeCropNow(e) {\n      e.preventDefault();\n      var nowX = \'clientX\' in e ? e.clientX : e.touches ? e.touches[0].clientX : 0;\n      var nowY = \'clientY\' in e ? e.clientY : e.touches ? e.touches[0].clientY : 0;\n      // 容器的宽高\n      let wrapperW = this.w;\n      let wrapperH = this.h;\n\n      // 不能超过的坐标轴\n      let minX = 0;\n      let minY = 0;\n\n      if (this.centerBox) {\n        let axis = this.getImgAxis();\n        let imgW = axis.x2;\n        let imgH = axis.y2;\n        minX = axis.x1 > 0 ? axis.x1 : 0;\n        minY = axis.y1 > 0 ? axis.y1 : 0;\n        if (wrapperW > imgW) {\n          wrapperW = imgW;\n        }\n\n        if (wrapperH > imgH) {\n          wrapperH = imgH;\n        }\n      }\n      const [minCropW,minCropH] = this.checkCropLimitSize()\n      this.$nextTick(() => {\n        var fw = nowX - this.cropX;\n        var fh = nowY - this.cropY;\n        if (this.canChangeX) {\n          if (this.changeCropTypeX === 1) {\n            if (this.cropOldW - fw < minCropW) {\n              this.cropW = minCropW\n              this.cropOffsertX = this.cropOldW + this.cropChangeX - minX - minCropW\n            } else if (this.cropOldW - fw > 0) {\n              this.cropW =\n                wrapperW - this.cropChangeX - fw <= wrapperW - minX\n                  ? this.cropOldW - fw\n                  : this.cropOldW + this.cropChangeX - minX;\n              this.cropOffsertX =\n                wrapperW - this.cropChangeX - fw <= wrapperW - minX\n                  ? this.cropChangeX + fw\n                  : minX;\n            } else {\n              this.cropW =\n                Math.abs(fw) + this.cropChangeX <= wrapperW\n                  ? Math.abs(fw) - this.cropOldW\n                  : wrapperW - this.cropOldW - this.cropChangeX;\n              this.cropOffsertX = this.cropChangeX + this.cropOldW;\n            }\n          } else if (this.changeCropTypeX === 2) {\n            if (this.cropOldW + fw < minCropW) {\n              this.cropW = minCropW\n            } else if (this.cropOldW + fw > 0) {\n              this.cropW =\n                this.cropOldW + fw + this.cropOffsertX <= wrapperW\n                  ? this.cropOldW + fw\n                  : wrapperW - this.cropOffsertX;\n              this.cropOffsertX = this.cropChangeX;\n            } else {\n              // 右侧坐标抽 超过左侧\n              this.cropW =\n                wrapperW - this.cropChangeX + Math.abs(fw + this.cropOldW) <=\n                wrapperW - minX\n                  ? Math.abs(fw + this.cropOldW)\n                  : this.cropChangeX - minX;\n              this.cropOffsertX =\n                wrapperW - this.cropChangeX + Math.abs(fw + this.cropOldW) <=\n                wrapperW - minX\n                  ? this.cropChangeX - Math.abs(fw + this.cropOldW)\n                  : minX;\n            }\n          }\n        }\n\n        if (this.canChangeY) {\n          if (this.changeCropTypeY === 1) {\n            if (this.cropOldH - fh < minCropH) {\n              this.cropH = minCropH\n              this.cropOffsertY = this.cropOldH + this.cropChangeY - minY - minCropH\n            } else if (this.cropOldH - fh > 0) {\n              this.cropH =\n                wrapperH - this.cropChangeY - fh <= wrapperH - minY\n                  ? this.cropOldH - fh\n                  : this.cropOldH + this.cropChangeY - minY;\n              this.cropOffsertY =\n                wrapperH - this.cropChangeY - fh <= wrapperH - minY\n                  ? this.cropChangeY + fh\n                  : minY;\n            } else {\n              this.cropH =\n                Math.abs(fh) + this.cropChangeY <= wrapperH\n                  ? Math.abs(fh) - this.cropOldH\n                  : wrapperH - this.cropOldH - this.cropChangeY;\n              this.cropOffsertY = this.cropChangeY + this.cropOldH;\n            }\n          } else if (this.changeCropTypeY === 2) {\n            if (this.cropOldH + fh < minCropH) {\n              this.cropH = minCropH\n            } else if (this.cropOldH + fh > 0) {\n              this.cropH =\n                this.cropOldH + fh + this.cropOffsertY <= wrapperH\n                  ? this.cropOldH + fh\n                  : wrapperH - this.cropOffsertY;\n              this.cropOffsertY = this.cropChangeY;\n            } else {\n              this.cropH =\n                wrapperH - this.cropChangeY + Math.abs(fh + this.cropOldH) <=\n                wrapperH - minY\n                  ? Math.abs(fh + this.cropOldH)\n                  : this.cropChangeY - minY;\n              this.cropOffsertY =\n                wrapperH - this.cropChangeY + Math.abs(fh + this.cropOldH) <=\n                wrapperH - minY\n                  ? this.cropChangeY - Math.abs(fh + this.cropOldH)\n                  : minY;\n            }\n          }\n        }\n\n        if (this.canChangeX && this.fixed) {\n          var fixedHeight =\n            (this.cropW / this.fixedNumber[0]) * this.fixedNumber[1];\n          if (fixedHeight < minCropH) {\n            this.cropH = minCropH\n            this.cropW = this.fixedNumber[0] * minCropH / this.fixedNumber[1]\n            // 这里需要去修改 offsetX的值，去调整因为高度变化而导致的宽度变化\n            if (this.changeCropTypeX === 1) {\n              this.cropOffsertX = this.cropChangeX + (this.cropOldW - this.cropW)\n            }\n          } else if (fixedHeight + this.cropOffsertY > wrapperH) {\n            this.cropH = wrapperH - this.cropOffsertY;\n            this.cropW =\n              (this.cropH / this.fixedNumber[1]) * this.fixedNumber[0];\n            if (this.changeCropTypeX === 1) {\n              this.cropOffsertX = this.cropChangeX + (this.cropOldW - this.cropW)\n            }\n          } else {\n            this.cropH = fixedHeight;\n          }\n        }\n\n        if (this.canChangeY && this.fixed) {\n          var fixedWidth =\n            (this.cropH / this.fixedNumber[1]) * this.fixedNumber[0];\n          if (fixedWidth < minCropW) {\n            this.cropW = minCropW\n            this.cropH = this.fixedNumber[1] * minCropW / this.fixedNumber[0];\n          } else if (fixedWidth + this.cropOffsertX > wrapperW) {\n            this.cropW = wrapperW - this.cropOffsertX;\n            this.cropH =\n              (this.cropW / this.fixedNumber[0]) * this.fixedNumber[1];\n          } else {\n            this.cropW = fixedWidth;\n          }\n        }\n\t// 触发截图框改变大小事件\n\tthis.$emit(\'cropSizing\', {cropW: this.cropW, cropH: this.cropH})\n\tthis.$emit(\'crop-sizing\', {cropW: this.cropW, cropH: this.cropH})\n      });\n    },\n\n    checkCropLimitSize () {\n      let { cropW, cropH, limitMinSize } = this;\n\n      let limitMinNum = new Array;\n      if (!Array.isArray(limitMinSize)) {\n        limitMinNum = [limitMinSize, limitMinSize]\n      } else {\n        limitMinNum = limitMinSize\n      }\n      \n      //限制最小宽度和高度\n      cropW = parseFloat(limitMinNum[0])\n      cropH = parseFloat(limitMinNum[1])\n      return [cropW, cropH]\n    },\n    // 结束改变\n    changeCropEnd(e) {\n      window.removeEventListener("mousemove", this.changeCropNow);\n      window.removeEventListener("mouseup", this.changeCropEnd);\n      window.removeEventListener("touchmove", this.changeCropNow);\n      window.removeEventListener("touchend", this.changeCropEnd);\n    },\n    // 根据比例x/y，最小宽度，最小高度，现有宽度，现有高度，得到应该有的宽度和高度\n    calculateSize(x, y, minX, minY, w, h) {\n      const ratio = x / y;\n      let width = w;\n      let height = h;\n      // 先根据最小宽度来计算高度\n      if (width < minX) {\n        width = minX;\n        height = Math.ceil(width / ratio);\n      }\n      // 如果计算出来的高度小于最小高度，则根据最小高度来重新计算宽度和高度\n      if (height < minY) {\n        height = minY;\n        width = Math.ceil(height * ratio);\n        // 如果重新计算的宽度仍然小于最小宽度，则使用最小宽度，并重新计算高度\n        if (width < minX) {\n          width = minX;\n          height = Math.ceil(width / ratio);\n        }\n      }\n      // 如果计算出来的宽度或高度小于输入的宽度或高度，则分别使用输入的宽度或高度\n      if (width < w) {\n        width = w;\n        height = Math.ceil(width / ratio);\n      }\n      if (height < h) {\n        height = h;\n        width = Math.ceil(height * ratio);\n      }\n      return { width, height };\n    },\n    // 创建完成\n    endCrop() {\n      if (this.cropW === 0 && this.cropH === 0) {\n        this.cropping = false;\n      }\n      let [minCropW, minCropH] = this.checkCropLimitSize();\n      const { width, height } = this.fixed ? this.calculateSize(\n        this.fixedNumber[0],\n        this.fixedNumber[1],\n        minCropW,\n        minCropH,\n        this.cropW,\n        this.cropH\n      ) : { width: minCropW, height: minCropH }\n      if (width > this.cropW) {\n        this.cropW = width;\n        if (this.cropOffsertX + width > this.w) {\n          this.cropOffsertX = this.w - width;\n        }\n      }\n      if (height > this.cropH) {\n        this.cropH = height;\n        if (this.cropOffsertY + height > this.h) {\n          this.cropOffsertY = this.h - height;\n        }\n      }\n      window.removeEventListener("mousemove", this.createCrop);\n      window.removeEventListener("mouseup", this.endCrop);\n      window.removeEventListener("touchmove", this.createCrop);\n      window.removeEventListener("touchend", this.endCrop);\n    },\n    // 开始截图\n    startCrop() {\n      this.crop = true;\n    },\n    // 停止截图\n    stopCrop() {\n      this.crop = false;\n    },\n    // 清除截图\n    clearCrop() {\n      this.cropping = false;\n      this.cropW = 0;\n      this.cropH = 0;\n    },\n    // 截图移动\n    cropMove(e) {\n      e.preventDefault();\n      if (!this.canMoveBox) {\n        this.crop = false;\n        this.startMove(e);\n        return false;\n      }\n\n      if (e.touches && e.touches.length === 2) {\n        this.crop = false;\n        this.startMove(e);\n        this.leaveCrop();\n        return false;\n      }\n      window.addEventListener("mousemove", this.moveCrop);\n      window.addEventListener("mouseup", this.leaveCrop);\n      window.addEventListener("touchmove", this.moveCrop);\n      window.addEventListener("touchend", this.leaveCrop);\n      let x = \'clientX\' in e ? e.clientX : e.touches[0].clientX;\n      let y = \'clientY\' in e ? e.clientY : e.touches[0].clientY;\n      let newX, newY;\n      newX = x - this.cropOffsertX;\n      newY = y - this.cropOffsertY;\n      this.cropX = newX;\n      this.cropY = newY;\n      // 触发截图框移动事件\n      this.$emit("cropMoving", {\n        moving: true,\n        axis: this.getCropAxis()\n      });\n      this.$emit("crop-moving", {\n        moving: true,\n        axis: this.getCropAxis()\n      });\n    },\n\n    moveCrop(e, isMove) {\n      let nowX = 0;\n      let nowY = 0;\n      if (e) {\n        e.preventDefault();\n        nowX = \'clientX\' in e ? e.clientX : e.touches[0].clientX;\n        nowY = \'clientY\' in e ? e.clientY : e.touches[0].clientY;\n      }\n      this.$nextTick(() => {\n        let cx, cy;\n        let fw = nowX - this.cropX;\n        let fh = nowY - this.cropY;\n        if (isMove) {\n          fw = this.cropOffsertX;\n          fh = this.cropOffsertY;\n        }\n        // 不能超过外层容器\n        if (fw <= 0) {\n          cx = 0;\n        } else if (fw + this.cropW > this.w) {\n          cx = this.w - this.cropW;\n        } else {\n          cx = fw;\n        }\n\n        if (fh <= 0) {\n          cy = 0;\n        } else if (fh + this.cropH > this.h) {\n          cy = this.h - this.cropH;\n        } else {\n          cy = fh;\n        }\n\n        // 不能超过图片\n        if (this.centerBox) {\n          let axis = this.getImgAxis();\n          // 横坐标判断\n          if (cx <= axis.x1) {\n            cx = axis.x1;\n          }\n\n          if (cx + this.cropW > axis.x2) {\n            cx = axis.x2 - this.cropW;\n          }\n\n          // 纵坐标纵轴\n          if (cy <= axis.y1) {\n            cy = axis.y1;\n          }\n\n          if (cy + this.cropH > axis.y2) {\n            cy = axis.y2 - this.cropH;\n          }\n        }\n\n        this.cropOffsertX = cx;\n        this.cropOffsertY = cy;\n\n        // 触发截图框移动事件\n        this.$emit("cropMoving", {\n          moving: true,\n          axis: this.getCropAxis()\n        });\n        this.$emit("crop-moving", {\n          moving: true,\n          axis: this.getCropAxis()\n        });\n      });\n    },\n\n    // 算出不同场景下面 图片相对于外层容器的坐标轴\n    getImgAxis(x, y, scale) {\n      x = x || this.x;\n      y = y || this.y;\n      scale = scale || this.scale;\n      // 如果设置了截图框在图片内， 那么限制截图框不能超过图片的坐标\n      // 图片的坐标\n      let obj = {\n        x1: 0,\n        x2: 0,\n        y1: 0,\n        y2: 0\n      };\n      let imgW = this.trueWidth * scale;\n      let imgH = this.trueHeight * scale;\n      switch (this.rotate) {\n        case 0:\n          obj.x1 = x + (this.trueWidth * (1 - scale)) / 2;\n          obj.x2 = obj.x1 + this.trueWidth * scale;\n          obj.y1 = y + (this.trueHeight * (1 - scale)) / 2;\n          obj.y2 = obj.y1 + this.trueHeight * scale;\n          break;\n        case 1:\n        case -1:\n        case 3:\n        case -3:\n          obj.x1 = x + (this.trueWidth * (1 - scale)) / 2 + (imgW - imgH) / 2;\n          obj.x2 = obj.x1 + this.trueHeight * scale;\n          obj.y1 = y + (this.trueHeight * (1 - scale)) / 2 + (imgH - imgW) / 2;\n          obj.y2 = obj.y1 + this.trueWidth * scale;\n          break;\n        default:\n          obj.x1 = x + (this.trueWidth * (1 - scale)) / 2;\n          obj.x2 = obj.x1 + this.trueWidth * scale;\n          obj.y1 = y + (this.trueHeight * (1 - scale)) / 2;\n          obj.y2 = obj.y1 + this.trueHeight * scale;\n          break;\n      }\n      return obj;\n    },\n\n    // 获取截图框的坐标轴\n    getCropAxis() {\n      let obj = {\n        x1: 0,\n        x2: 0,\n        y1: 0,\n        y2: 0\n      };\n      obj.x1 = this.cropOffsertX;\n      obj.x2 = obj.x1 + this.cropW;\n      obj.y1 = this.cropOffsertY;\n      obj.y2 = obj.y1 + this.cropH;\n      return obj;\n    },\n\n    leaveCrop(e) {\n      window.removeEventListener("mousemove", this.moveCrop);\n      window.removeEventListener("mouseup", this.leaveCrop);\n      window.removeEventListener("touchmove", this.moveCrop);\n      window.removeEventListener("touchend", this.leaveCrop);\n      // 触发截图框移动事件\n      this.$emit("cropMoving", {\n        moving: false,\n        axis: this.getCropAxis()\n      });\n      this.$emit("crop-moving", {\n        moving: false,\n        axis: this.getCropAxis()\n      });\n    },\n\n    getCropChecked(cb) {\n      let canvas = document.createElement("canvas");\n      let ctx = canvas.getContext("2d");\n      let img = new Image();\n      let rotate = this.rotate;\n      let trueWidth = this.trueWidth;\n      let trueHeight = this.trueHeight;\n      let cropOffsertX = this.cropOffsertX;\n      let cropOffsertY = this.cropOffsertY;\n      img.onload = () => {\n        if (this.cropW !== 0) {\n          let dpr = 1;\n          if (this.high & !this.full) {\n            dpr = window.devicePixelRatio;\n          }\n          if ((this.enlarge !== 1) & !this.full) {\n            dpr = Math.abs(Number(this.enlarge));\n          }\n          let width = this.cropW * dpr;\n          let height = this.cropH * dpr;\n          let imgW = trueWidth * this.scale * dpr;\n          let imgH = trueHeight * this.scale * dpr;\n          // 图片x轴偏移\n          let dx =\n            (this.x - cropOffsertX + (this.trueWidth * (1 - this.scale)) / 2) *\n            dpr;\n          // 图片y轴偏移\n          let dy =\n            (this.y - cropOffsertY + (this.trueHeight * (1 - this.scale)) / 2) *\n            dpr;\n          //保存状态\n          setCanvasSize(width, height);\n          ctx.save();\n          switch (rotate) {\n            case 0:\n              if (!this.full) {\n                ctx.drawImage(img, dx, dy, imgW, imgH);\n              } else {\n                // 输出原图比例截图\n                setCanvasSize(width / this.scale, height / this.scale);\n                ctx.drawImage(\n                  img,\n                  dx / this.scale,\n                  dy / this.scale,\n                  imgW / this.scale,\n                  imgH / this.scale\n                );\n              }\n              break;\n            case 1:\n            case -3:\n              if (!this.full) {\n                // 换算图片旋转后的坐标弥补\n                dx = dx + (imgW - imgH) / 2;\n                dy = dy + (imgH - imgW) / 2;\n                ctx.rotate((rotate * 90 * Math.PI) / 180);\n                ctx.drawImage(img, dy, -dx - imgH, imgW, imgH);\n              } else {\n                setCanvasSize(width / this.scale, height / this.scale);\n                // 换算图片旋转后的坐标弥补\n                dx =\n                  dx / this.scale + (imgW / this.scale - imgH / this.scale) / 2;\n                dy =\n                  dy / this.scale + (imgH / this.scale - imgW / this.scale) / 2;\n                ctx.rotate((rotate * 90 * Math.PI) / 180);\n                ctx.drawImage(\n                  img,\n                  dy,\n                  -dx - imgH / this.scale,\n                  imgW / this.scale,\n                  imgH / this.scale\n                );\n              }\n              break;\n            case 2:\n            case -2:\n              if (!this.full) {\n                ctx.rotate((rotate * 90 * Math.PI) / 180);\n                ctx.drawImage(img, -dx - imgW, -dy - imgH, imgW, imgH);\n              } else {\n                setCanvasSize(width / this.scale, height / this.scale);\n                ctx.rotate((rotate * 90 * Math.PI) / 180);\n                dx = dx / this.scale;\n                dy = dy / this.scale;\n                ctx.drawImage(\n                  img,\n                  -dx - imgW / this.scale,\n                  -dy - imgH / this.scale,\n                  imgW / this.scale,\n                  imgH / this.scale\n                );\n              }\n              break;\n            case 3:\n            case -1:\n              if (!this.full) {\n                // 换算图片旋转后的坐标弥补\n                dx = dx + (imgW - imgH) / 2;\n                dy = dy + (imgH - imgW) / 2;\n                ctx.rotate((rotate * 90 * Math.PI) / 180);\n                ctx.drawImage(img, -dy - imgW, dx, imgW, imgH);\n              } else {\n                setCanvasSize(width / this.scale, height / this.scale);\n                // 换算图片旋转后的坐标弥补\n                dx =\n                  dx / this.scale + (imgW / this.scale - imgH / this.scale) / 2;\n                dy =\n                  dy / this.scale + (imgH / this.scale - imgW / this.scale) / 2;\n                ctx.rotate((rotate * 90 * Math.PI) / 180);\n                ctx.drawImage(\n                  img,\n                  -dy - imgW / this.scale,\n                  dx,\n                  imgW / this.scale,\n                  imgH / this.scale\n                );\n              }\n              break;\n            default:\n              if (!this.full) {\n                ctx.drawImage(img, dx, dy, imgW, imgH);\n              } else {\n                // 输出原图比例截图\n                setCanvasSize(width / this.scale, height / this.scale);\n                ctx.drawImage(\n                  img,\n                  dx / this.scale,\n                  dy / this.scale,\n                  imgW / this.scale,\n                  imgH / this.scale\n                );\n              }\n          }\n          ctx.restore();\n        } else {\n          let width = trueWidth * this.scale;\n          let height = trueHeight * this.scale;\n          ctx.save();\n          switch (rotate) {\n            case 0:\n              setCanvasSize(width, height);\n              ctx.drawImage(img, 0, 0, width, height);\n              break;\n            case 1:\n            case -3:\n              // 旋转90度 或者-270度 宽度和高度对调\n              setCanvasSize(height, width);\n              ctx.rotate((rotate * 90 * Math.PI) / 180);\n              ctx.drawImage(img, 0, -height, width, height);\n              break;\n            case 2:\n            case -2:\n              setCanvasSize(width, height);\n              ctx.rotate((rotate * 90 * Math.PI) / 180);\n              ctx.drawImage(img, -width, -height, width, height);\n              break;\n            case 3:\n            case -1:\n              setCanvasSize(height, width);\n              ctx.rotate((rotate * 90 * Math.PI) / 180);\n              ctx.drawImage(img, -width, 0, width, height);\n              break;\n            default:\n              setCanvasSize(width, height);\n              ctx.drawImage(img, 0, 0, width, height);\n          }\n          ctx.restore();\n        }\n        cb(canvas);\n      };\n      // 判断图片是否是base64\n      var s = this.img.substr(0, 4);\n      if (s !== "data") {\n        img.crossOrigin = "Anonymous";\n      }\n      img.src = this.imgs;\n      const fillColor = this.fillColor;\n      function setCanvasSize(width, height) {\n        canvas.width = Math.round(width);\n        canvas.height = Math.round(height);\n        // 填充背景颜色\n        if (fillColor) {\n          ctx.fillStyle = fillColor;\n          ctx.fillRect(0, 0, canvas.width, canvas.height);\n        }\n      }\n    },\n\n    // 获取转换成base64 的图片信息\n    getCropData(cb) {\n      this.getCropChecked(data => {\n        cb(data.toDataURL("image/" + this.outputType, this.outputSize));\n      });\n    },\n\n    //canvas获取为blob对象\n    getCropBlob(cb) {\n      this.getCropChecked(data => {\n        data.toBlob(\n          blob => cb(blob),\n          "image/" + this.outputType,\n          this.outputSize\n        );\n      });\n    },\n\n    // 自动预览函数\n    showPreview() {\n      // 优化不要多次触发\n      if (this.isCanShow) {\n        this.isCanShow = false;\n        setTimeout(() => {\n          this.isCanShow = true;\n        }, 16);\n      } else {\n        return false;\n      }\n      let w = this.cropW;\n      let h = this.cropH;\n      let scale = this.scale;\n      var obj = {};\n      obj.div = {\n        width: `${w}px`,\n        height: `${h}px`\n      };\n      let transformX = (this.x - this.cropOffsertX) / scale;\n      let transformY = (this.y - this.cropOffsertY) / scale;\n      let transformZ = 0;\n      obj.w = w;\n      obj.h = h;\n      obj.url = this.imgs;\n      obj.img = {\n        width: `${this.trueWidth}px`,\n        height: `${this.trueHeight}px`,\n        transform: `scale(${scale})translate3d(${transformX}px, ${transformY}px, ${transformZ}px)rotateZ(${this\n          .rotate * 90}deg)`\n      };\n      obj.html = `\n      <div class="show-preview" style="width: ${obj.w}px; height: ${\n        obj.h\n      }px; overflow: hidden">\n        <div style="width: ${w}px; height: ${h}px">\n          <img src=${obj.url} style="width: ${this.trueWidth}px; height: ${\n        this.trueHeight\n      }px; transform:\n          scale(${scale})translate3d(${transformX}px, ${transformY}px, ${transformZ}px)rotateZ(${this\n        .rotate * 90}deg)">\n        </div>\n      </div>`;\n      this.$emit("realTime", obj);\n      this.$emit("real-time", obj);\n    },\n    // reload 图片布局函数\n    reload() {\n      let img = new Image();\n      img.onload = () => {\n        // 读取图片的信息原始信息， 解析是否需要旋转\n        // 读取图片的旋转信息\n        // 得到外层容器的宽度高度\n        this.w = parseFloat(window.getComputedStyle(this.$refs.cropper).width);\n        this.h = parseFloat(window.getComputedStyle(this.$refs.cropper).height);\n\n        // 存入图片真实高度\n        this.trueWidth = img.width;\n        this.trueHeight = img.height;\n\n        // 判断是否需要压缩大图\n        if (!this.original) {\n          // 判断布局方式 mode\n          this.scale = this.checkedMode();\n        } else {\n          this.scale = 1;\n        }\n\n        this.$nextTick(() => {\n          this.x =\n            -(this.trueWidth - this.trueWidth * this.scale) / 2 +\n            (this.w - this.trueWidth * this.scale) / 2;\n          this.y =\n            -(this.trueHeight - this.trueHeight * this.scale) / 2 +\n            (this.h - this.trueHeight * this.scale) / 2;\n          this.loading = false;\n          // // 获取是否开启了自动截图\n          if (this.autoCrop) {\n            this.goAutoCrop();\n          }\n          // 图片加载成功的回调\n          this.$emit("img-load", "success");\n          this.$emit("imgLoad", "success");        \n          setTimeout(() => {\n            this.showPreview();\n          }, 20);\n        });\n      };\n      img.onerror = () => {\n        this.$emit("imgLoad", "error");\n        this.$emit("img-load", "error");\n      };\n      img.src = this.imgs;\n    },\n    // 背景布局的函数\n    checkedMode() {\n      let scale = 1;\n      // 通过字符串分割\n      let imgW = this.trueWidth;\n      let imgH = this.trueHeight;\n      const arr = this.mode.split(" ");\n      switch (arr[0]) {\n        case "contain":\n          if (this.trueWidth > this.w) {\n            // 如果图片宽度大于容器宽度\n            scale = this.w / this.trueWidth;\n          }\n\n          if (this.trueHeight * scale > this.h) {\n            scale = this.h / this.trueHeight;\n          }\n          break;\n        case "cover":\n          // 扩展布局 默认填充满整个容器\n          // 图片宽度大于容器\n          imgW = this.w;\n          scale = imgW / this.trueWidth;\n          imgH = imgH * scale;\n          // 如果扩展之后高度小于容器的外层高度 继续扩展高度\n          if (imgH < this.h) {\n            imgH = this.h;\n            scale = imgH / this.trueHeight;\n          }\n          break;\n        default:\n          try {\n            let str = arr[0];\n            if (str.search("px") !== -1) {\n              str = str.replace("px", "");\n              imgW = parseFloat(str);\n              const scaleX = imgW / this.trueWidth;\n              let scaleY = 1;\n              let strH = arr[1];\n              if (strH.search("px") !== -1) {\n                strH = strH.replace("px", "");\n                imgH = parseFloat(strH);\n                scaleY = imgH / this.trueHeight;\n              }\n              scale = Math.min(scaleX,scaleY)\n\n            }\n            if (str.search("%") !== -1) {\n              str = str.replace("%", "");\n              imgW = (parseFloat(str) / 100) * this.w;\n              scale = imgW / this.trueWidth;\n            }\n\n            if (arr.length === 2 && str === "auto") {\n              let str2 = arr[1];\n              if (str2.search("px") !== -1) {\n                str2 = str2.replace("px", "");\n                imgH = parseFloat(str2);\n                scale = imgH / this.trueHeight;\n              }\n              if (str2.search("%") !== -1) {\n                str2 = str2.replace("%", "");\n                imgH = (parseFloat(str2) / 100) * this.h;\n                scale = imgH / this.trueHeight;\n              }\n            }\n          } catch (error) {\n            scale = 1;\n          }\n      }\n      return scale;\n    },\n    // 自动截图函数\n    goAutoCrop(cw, ch) {\n      if (this.imgs === \'\' || this.imgs === null) return\n      this.clearCrop();\n      this.cropping = true;\n      let maxWidth = this.w;\n      let maxHeight = this.h;\n      if (this.centerBox) {\n        const switchWH = Math.abs(this.rotate) % 2 > 0\n        let imgW = (switchWH ? this.trueHeight : this.trueWidth) * this.scale;\n        let imgH = (switchWH ? this.trueWidth : this.trueHeight) * this.scale;\n        maxWidth = imgW < maxWidth ? imgW : maxWidth;\n        maxHeight = imgH < maxHeight ? imgH : maxHeight;\n      }\n      // 截图框默认大小\n      // 如果为0 那么计算容器大小 默认为80%\n      var w = cw ? cw : parseFloat(this.autoCropWidth);\n      var h = ch ? ch : parseFloat(this.autoCropHeight);\n      if (w === 0 || h === 0) {\n        w = maxWidth * 0.8;\n        h = maxHeight * 0.8;\n      }\n      w = w > maxWidth ? maxWidth : w;\n      h = h > maxHeight ? maxHeight : h;\n      if (this.fixed) {\n        h = (w / this.fixedNumber[0]) * this.fixedNumber[1];\n      }\n      // 如果比例之后 高度大于h\n      if (h > this.h) {\n        h = this.h;\n        w = (h / this.fixedNumber[1]) * this.fixedNumber[0];\n      }\n      this.changeCrop(w, h);\n    },\n    // 手动改变截图框大小函数\n    changeCrop(w, h) {\n      if (this.centerBox) {\n        // 修复初始化时候在centerBox=true情况下\n        let axis = this.getImgAxis();\n        if (w > axis.x2 - axis.x1) {\n          // 宽度超标\n          w = axis.x2 - axis.x1;\n          h = (w / this.fixedNumber[0]) * this.fixedNumber[1];\n        }\n        if (h > axis.y2 - axis.y1) {\n          // 高度超标\n          h = axis.y2 - axis.y1;\n          w = (h / this.fixedNumber[1]) * this.fixedNumber[0];\n        }\n      }\n      // 判断是否大于容器\n      this.cropW = w;\n      this.cropH = h;\n      this.checkCropLimitSize()\n      this.$nextTick(() => {\n        // 居中走一走\n        this.cropOffsertX = (this.w - this.cropW) / 2;\n        this.cropOffsertY = (this.h - this.cropH) / 2;\n        if (this.centerBox) {\n          this.moveCrop(null, true);\n        }\n      });\n    },\n    // 重置函数， 恢复组件置初始状态\n    refresh() {\n      let img = this.img;\n      this.imgs = "";\n      this.scale = 1;\n      this.crop = false;\n      this.rotate = 0;\n      this.w = 0;\n      this.h = 0;\n      this.trueWidth = 0;\n      this.trueHeight = 0;\n      this.clearCrop();\n      this.$nextTick(() => {\n        this.checkedImg();\n      });\n    },\n\n    // 向左边旋转\n    rotateLeft() {\n      this.rotate = this.rotate <= -3 ? 0 : this.rotate - 1;\n    },\n\n    // 向右边旋转\n    rotateRight() {\n      this.rotate = this.rotate >= 3 ? 0 : this.rotate + 1;\n    },\n\n    // 清除旋转\n    rotateClear() {\n      this.rotate = 0;\n    },\n\n    // 图片坐标点校验\n    checkoutImgAxis(x, y, scale) {\n      x = x || this.x;\n      y = y || this.y;\n      scale = scale || this.scale;\n      let canGo = true;\n      // 开始校验 如果说缩放之后的坐标在截图框外 则阻止缩放\n      if (this.centerBox) {\n        let axis = this.getImgAxis(x, y, scale);\n        let cropAxis = this.getCropAxis();\n        // 左边的横坐标 图片不能超过截图框\n        if (axis.x1 >= cropAxis.x1) {\n          canGo = false;\n        }\n\n        // 右边横坐标\n        if (axis.x2 <= cropAxis.x2) {\n          canGo = false;\n        }\n\n        // 纵坐标上面\n        if (axis.y1 >= cropAxis.y1) {\n          canGo = false;\n        }\n\n        // 纵坐标下面\n        if (axis.y2 <= cropAxis.y2) {\n          canGo = false;\n        }\n        if (!canGo) {\n          this.changeImgScale(axis, cropAxis, scale);\n        }\n      }\n      return canGo;\n    },\n    // 缩放图片，将图片坐标适配截图框坐标\n    changeImgScale(axis, cropAxis, scale) {\n      // 左右旋转90度时，长宽互换位置, 也就是 1 和 -1的时候\n      let trueWidth = this.trueWidth;\n      let trueHeight = this.trueHeight;\n      let imgW = trueWidth * scale;\n      let imgH = trueHeight * scale;\n      if (imgW >= this.cropW && imgH >= this.cropH) {\n        this.scale = scale;\n      } else {\n        const cropWScale = this.cropW / trueWidth;\n        const cropHScale = this.cropH / trueHeight;\n        const cropScale = this.cropH <= trueHeight * cropWScale ? cropWScale : cropHScale;\n        this.scale = cropScale;\n        imgW = trueWidth * cropScale;\n        imgH = trueHeight * cropScale;\n      }\n      // 用来做移动坐标判断\n      if (!this.imgIsQqualCrop) {\n        // 左边的横坐标 图片不能超过截图框\n        if (axis.x1 >= cropAxis.x1) {\n          if (this.isRotateRightOrLeft) {\n            this.x = cropAxis.x1 - (trueWidth - imgW) / 2 - (imgW - imgH) / 2;\n          } else {\n            this.x = cropAxis.x1 - (trueWidth - imgW) / 2;\n          }\n        }\n        // 右边横坐标\n        if (axis.x2 <= cropAxis.x2) {\n          if (this.isRotateRightOrLeft) {\n            this.x = cropAxis.x1 - (trueWidth - imgW) / 2 - (imgW - imgH) / 2 - imgH + this.cropW;\n          } else {\n            this.x = cropAxis.x2 - (trueWidth - imgW) / 2 - imgW;\n          }\n        }\n        // 纵坐标上面\n        if (axis.y1 >= cropAxis.y1) {\n          if (this.isRotateRightOrLeft) {\n            this.y = cropAxis.y1 - (trueHeight - imgH) / 2 - (imgH - imgW) / 2;\n          } else {\n            this.y = cropAxis.y1 - (trueHeight - imgH) / 2;\n          }\n        }\n        // 纵坐标下面\n        if (axis.y2 <= cropAxis.y2) {\n          if (this.isRotateRightOrLeft) {\n            this.y = cropAxis.y2 - (trueHeight - imgH)/2 - (imgH - imgW) / 2 - imgW;\n          } else {\n            this.y = cropAxis.y2 - (trueHeight - imgH)/2 - imgH;\n          }\n        }\n      }\n      if (imgW < this.cropW || imgH < this.cropH) {\n        this.imgIsQqualCrop = true;\n      }\n    }\n  },\n  mounted() {\n    this.support =\n      "onwheel" in document.createElement("div")\n        ? "wheel"\n        : document.onmousewheel !== undefined\n        ? "mousewheel"\n        : "DOMMouseScroll";\n    let that = this;\n    var u = navigator.userAgent;\n    this.isIOS = !!u.match(/\\(i[^;]+;( U;)? CPU.+Mac OS X/);\n    // 兼容blob\n    if (!HTMLCanvasElement.prototype.toBlob) {\n      Object.defineProperty(HTMLCanvasElement.prototype, "toBlob", {\n        value: function(callback, type, quality) {\n          var binStr = atob(this.toDataURL(type, quality).split(",")[1]),\n            len = binStr.length,\n            arr = new Uint8Array(len);\n          for (var i = 0; i < len; i++) {\n            arr[i] = binStr.charCodeAt(i);\n          }\n          callback(new Blob([arr], { type: that.type || "image/png" }));\n        }\n      });\n    }\n    this.showPreview();\n    this.checkedImg();\n  },\n  destroyed() {\n    window.removeEventListener("mousemove", this.moveCrop);\n    window.removeEventListener("mouseup", this.leaveCrop);\n    window.removeEventListener("touchmove", this.moveCrop);\n    window.removeEventListener("touchend", this.leaveCrop);\n    this.cancelScale()\n  }\n};\n<\/script>\n\n<style scoped lang="css">\n.vue-cropper {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  user-select: none;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  direction: ltr;\n  touch-action: none;\n  text-align: left;\n  background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC");\n}\n\n.cropper-box,\n.cropper-box-canvas,\n.cropper-drag-box,\n.cropper-crop-box,\n.cropper-face {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  user-select: none;\n}\n\n.cropper-box-canvas img {\n  position: relative;\n  text-align: left;\n  user-select: none;\n  transform: none;\n  max-width: none;\n  max-height: none;\n}\n\n.cropper-box {\n  overflow: hidden;\n}\n\n.cropper-move {\n  cursor: move;\n}\n\n.cropper-crop {\n  cursor: crosshair;\n}\n\n.cropper-modal {\n  background: rgba(0, 0, 0, 0.5);\n}\n\n.cropper-crop-box {\n  /*border: 2px solid #39f;*/\n}\n\n.cropper-view-box {\n  display: block;\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  outline: 1px solid #39f;\n  outline-color: rgba(51, 153, 255, 0.75);\n  user-select: none;\n}\n\n.cropper-view-box img {\n  user-select: none;\n  text-align: left;\n  max-width: none;\n  max-height: none;\n}\n\n.cropper-face {\n  top: 0;\n  left: 0;\n  background-color: #fff;\n  opacity: 0.1;\n}\n\n.crop-info {\n  position: absolute;\n  left: 0px;\n  min-width: 65px;\n  text-align: center;\n  color: white;\n  line-height: 20px;\n  background-color: rgba(0, 0, 0, 0.8);\n  font-size: 12px;\n}\n\n.crop-line {\n  position: absolute;\n  display: block;\n  width: 100%;\n  height: 100%;\n  opacity: 0.1;\n}\n\n.line-w {\n  top: -3px;\n  left: 0;\n  height: 5px;\n  cursor: n-resize;\n}\n\n.line-a {\n  top: 0;\n  left: -3px;\n  width: 5px;\n  cursor: w-resize;\n}\n\n.line-s {\n  bottom: -3px;\n  left: 0;\n  height: 5px;\n  cursor: s-resize;\n}\n\n.line-d {\n  top: 0;\n  right: -3px;\n  width: 5px;\n  cursor: e-resize;\n}\n\n.crop-point {\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  opacity: 0.75;\n  background-color: #39f;\n  border-radius: 100%;\n}\n\n.point1 {\n  top: -4px;\n  left: -4px;\n  cursor: nw-resize;\n}\n\n.point2 {\n  top: -5px;\n  left: 50%;\n  margin-left: -3px;\n  cursor: n-resize;\n}\n\n.point3 {\n  top: -4px;\n  right: -4px;\n  cursor: ne-resize;\n}\n\n.point4 {\n  top: 50%;\n  left: -4px;\n  margin-top: -3px;\n  cursor: w-resize;\n}\n\n.point5 {\n  top: 50%;\n  right: -4px;\n  margin-top: -3px;\n  cursor: e-resize;\n}\n\n.point6 {\n  bottom: -5px;\n  left: -4px;\n  cursor: sw-resize;\n}\n\n.point7 {\n  bottom: -5px;\n  left: 50%;\n  margin-left: -3px;\n  cursor: s-resize;\n}\n\n.point8 {\n  bottom: -5px;\n  right: -4px;\n  cursor: se-resize;\n}\n\n@media screen and (max-width: 500px) {\n  .crop-point {\n    position: absolute;\n    width: 20px;\n    height: 20px;\n    opacity: 0.45;\n    background-color: #39f;\n    border-radius: 100%;\n  }\n\n  .point1 {\n    top: -10px;\n    left: -10px;\n  }\n\n  .point2,\n  .point4,\n  .point5,\n  .point7 {\n    display: none;\n  }\n\n  .point3 {\n    top: -10px;\n    right: -10px;\n  }\n\n  .point4 {\n    top: 0;\n    left: 0;\n  }\n\n  .point6 {\n    bottom: -10px;\n    left: -10px;\n  }\n\n  .point8 {\n    bottom: -10px;\n    right: -10px;\n  }\n}\n</style>\n'],sourceRoot:""}]);const u=p},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",i=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),i&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),i&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,i,r,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(i)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(s[h]=!0)}for(var c=0;c<e.length;c++){var p=[].concat(e[c]);i&&s[p[0]]||(void 0!==o&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=o),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),r&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=r):p[4]="".concat(r)),t.push(p))}},t}},417:e=>{e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},354:e=>{e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(r," */");return[t].concat([o]).join("\n")}return[t].join("\n")}},72:e=>{var t=[];function n(e){for(var n=-1,i=0;i<t.length;i++)if(t[i].identifier===e){n=i;break}return n}function i(e,i){for(var o={},s=[],a=0;a<e.length;a++){var h=e[a],c=i.base?h[0]+i.base:h[0],p=o[c]||0,l="".concat(c," ").concat(p);o[c]=p+1;var u=n(l),d={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==u)t[u].references++,t[u].updater(d);else{var f=r(d,i);i.byIndex=a,t.splice(a,0,{identifier:l,updater:f,references:1})}s.push(l)}return s}function r(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,r){var o=i(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var h=i(e,r),c=0;c<o.length;c++){var p=n(o[c]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}o=h}}},659:e=>{var t={};e.exports=function(e,n){var i=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},107:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC"}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={id:i,exports:{}};return e[i](o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.b=document.baseURI||self.location.href,n.nc=void 0;var i={};return(()=>{n.r(i),n.d(i,{VueCropper:()=>y,default:()=>W});var e=function(){var e=this,t=e._self._c;return t("div",{ref:"cropper",staticClass:"vue-cropper",on:{mouseover:e.scaleImg,mouseout:e.cancelScale}},[e.imgs?t("div",{staticClass:"cropper-box"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.loading,expression:"!loading"}],staticClass:"cropper-box-canvas",style:{width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+90*e.rotate+"deg)"}},[t("img",{ref:"cropperImg",attrs:{src:e.imgs,alt:"cropper-img"}})])]):e._e(),e._v(" "),t("div",{staticClass:"cropper-drag-box",class:{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping},on:{mousedown:e.startMove,touchstart:e.startMove}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.cropping,expression:"cropping"}],staticClass:"cropper-crop-box",style:{width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"}},[t("span",{staticClass:"cropper-view-box"},[t("img",{style:{width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+90*e.rotate+"deg)"},attrs:{src:e.imgs,alt:"cropper-img"}})]),e._v(" "),t("span",{staticClass:"cropper-face cropper-move",on:{mousedown:e.cropMove,touchstart:e.cropMove}}),e._v(" "),e.info?t("span",{staticClass:"crop-info",style:{top:e.cropInfo.top}},[e._v(e._s(e.cropInfo.width)+" × "+e._s(e.cropInfo.height))]):e._e(),e._v(" "),e.fixedBox?e._e():t("span",[t("span",{staticClass:"crop-line line-w",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,1)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,1)}}}),e._v(" "),t("span",{staticClass:"crop-line line-a",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,1,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,1,0)}}}),e._v(" "),t("span",{staticClass:"crop-line line-s",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,2)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,2)}}}),e._v(" "),t("span",{staticClass:"crop-line line-d",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,2,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,2,0)}}}),e._v(" "),t("span",{staticClass:"crop-point point1",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,1,1)},touchstart:function(t){return e.changeCropSize(t,!0,!0,1,1)}}}),e._v(" "),t("span",{staticClass:"crop-point point2",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,1)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,1)}}}),e._v(" "),t("span",{staticClass:"crop-point point3",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,2,1)},touchstart:function(t){return e.changeCropSize(t,!0,!0,2,1)}}}),e._v(" "),t("span",{staticClass:"crop-point point4",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,1,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,1,0)}}}),e._v(" "),t("span",{staticClass:"crop-point point5",on:{mousedown:function(t){return e.changeCropSize(t,!0,!1,2,0)},touchstart:function(t){return e.changeCropSize(t,!0,!1,2,0)}}}),e._v(" "),t("span",{staticClass:"crop-point point6",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,1,2)},touchstart:function(t){return e.changeCropSize(t,!0,!0,1,2)}}}),e._v(" "),t("span",{staticClass:"crop-point point7",on:{mousedown:function(t){return e.changeCropSize(t,!1,!0,0,2)},touchstart:function(t){return e.changeCropSize(t,!1,!0,0,2)}}}),e._v(" "),t("span",{staticClass:"crop-point point8",on:{mousedown:function(t){return e.changeCropSize(t,!0,!0,2,2)},touchstart:function(t){return e.changeCropSize(t,!0,!0,2,2)}}})])])])};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o,s,a=[],h=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=o.call(n)).done)&&(a.push(i.value),a.length!==t);h=!0);}catch(e){c=!0,r=e}finally{try{if(!h&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}e._withStripped=!0;var o={getData:function(e){return new Promise((function(t,n){var i={};(function(e){var t=null;return new Promise((function(n,i){if(e.src)if(/^data\:/i.test(e.src))t=function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),i=n.length%2==0?n.length:n.length+1,r=new ArrayBuffer(i),o=new Uint16Array(r),s=0;s<i;s++)o[s]=n.charCodeAt(s);return r}(e.src),n(t);else if(/^blob\:/i.test(e.src)){var r=new FileReader;r.onload=function(e){t=e.target.result,n(t)},function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){var t;200!=this.status&&0!==this.status||(t=this.response,r.readAsArrayBuffer(t))},n.send()}(e.src)}else{var o=new XMLHttpRequest;o.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";t=o.response,n(t),o=null},o.open("GET",e.src,!0),o.responseType="arraybuffer",o.send(null)}else i("img error")}))})(e).then((function(e){i.arrayBuffer=e;try{i.orientation=function(e){var t,n,i,r,o,s,a,h,c,p=new DataView(e),l=p.byteLength;if(255===p.getUint8(0)&&216===p.getUint8(1))for(h=2;h<l;){if(255===p.getUint8(h)&&225===p.getUint8(h+1)){s=h;break}h++}if(s&&(n=s+10,"Exif"===function(e,t,n){var i,r="";for(i=t,n+=t;i<n;i++)r+=String.fromCharCode(e.getUint8(i));return r}(p,s+4,4)&&((r=18761===(o=p.getUint16(n)))||19789===o)&&42===p.getUint16(n+2,r)&&(i=p.getUint32(n+4,r))>=8&&(a=n+i)),a)for(l=p.getUint16(a,r),c=0;c<l;c++)if(h=a+12*c+2,274===p.getUint16(h,r)){h+=8,t=p.getUint16(h,r);break}return t}(e)}catch(e){i.orientation=-1}t(i)})).catch((function(e){n(e)}))}))}};const s=o,a={data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0,imgIsQqualCrop:!1}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:function(){return[1,1]}},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:[Number,String],default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"},limitMinSize:{type:[Number,Array,String],default:function(){return 10},validator:function(e){return Array.isArray(e)?Number(e[0])>=0&&Number(e[1])>=0:Number(e)>=0}},fillColor:{type:String,default:""}},computed:{cropInfo:function(){var e={};if(e.top=this.cropOffsertY>21?"-21px":"0px",e.width=this.cropW>0?this.cropW:0,e.height=this.cropH>0?this.cropH:0,this.infoTrue){var t=1;this.high&&!this.full&&(t=window.devicePixelRatio),1!==this.enlarge&!this.full&&(t=Math.abs(Number(this.enlarge))),e.width=e.width*t,e.height=e.height*t,this.full&&(e.width=e.width/this.scale,e.height=e.height/this.scale)}return e.width=e.width.toFixed(0),e.height=e.height.toFixed(0),e},isIE:function(){return navigator.userAgent,!!window.ActiveXObject||"ActiveXObject"in window},passive:function(){return this.isIE?null:{passive:!1}}},watch:{img:function(){this.checkedImg()},imgs:function(e){""!==e&&this.reload()},cropW:function(){this.showPreview()},cropH:function(){this.showPreview()},cropOffsertX:function(){this.showPreview()},cropOffsertY:function(){this.showPreview()},scale:function(e,t){this.showPreview()},x:function(){this.showPreview()},y:function(){this.showPreview()},autoCrop:function(e){e&&this.goAutoCrop()},autoCropWidth:function(){this.autoCrop&&this.goAutoCrop()},autoCropHeight:function(){this.autoCrop&&this.goAutoCrop()},mode:function(){this.checkedImg()},rotate:function(){this.showPreview(),(this.autoCrop||this.cropW>0||this.cropH>0)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{getVersion:function(e){for(var t=navigator.userAgent.split(" "),n="",i=new RegExp(e,"i"),r=0;r<t.length;r++)i.test(t[r])&&(n=t[r]);return n?n.split("/")[1].split("."):["0","0","0"]},checkOrientationImage:function(e,t,n,i){var r=this;if(this.getVersion("chrome")[0]>=81)t=-1;else if(this.getVersion("safari")[0]>=605){var o=this.getVersion("version");o[0]>13&&o[1]>1&&(t=-1)}else{var s=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);if(s){var a=s[1];((a=a.split("_"))[0]>13||a[0]>=13&&a[1]>=4)&&(t=-1)}}var h=document.createElement("canvas"),c=h.getContext("2d");switch(c.save(),t){case 2:h.width=n,h.height=i,c.translate(n,0),c.scale(-1,1);break;case 3:h.width=n,h.height=i,c.translate(n/2,i/2),c.rotate(180*Math.PI/180),c.translate(-n/2,-i/2);break;case 4:h.width=n,h.height=i,c.translate(0,i),c.scale(1,-1);break;case 5:h.height=n,h.width=i,c.rotate(.5*Math.PI),c.scale(1,-1);break;case 6:h.width=i,h.height=n,c.translate(i/2,n/2),c.rotate(90*Math.PI/180),c.translate(-n/2,-i/2);break;case 7:h.height=n,h.width=i,c.rotate(.5*Math.PI),c.translate(n,-i),c.scale(-1,1);break;case 8:h.height=n,h.width=i,c.translate(i/2,n/2),c.rotate(-90*Math.PI/180),c.translate(-n/2,-i/2);break;default:h.width=n,h.height=i}c.drawImage(e,0,0,n,i),c.restore(),h.toBlob((function(e){var t=URL.createObjectURL(e);URL.revokeObjectURL(r.imgs),r.imgs=t}),"image/"+this.outputType,1)},checkedImg:function(){var e=this;if(null===this.img||""===this.img)return this.imgs="",void this.clearCrop();this.loading=!0,this.scale=1,this.rotate=0,this.clearCrop();var t=new Image;if(t.onload=function(){if(""===e.img)return e.$emit("imgLoad","error"),e.$emit("img-load","error"),e.$emit("img-load",new Error("图片不能为空")),!1;var n=t.width,i=t.height;s.getData(t).then((function(r){e.orientation=r.orientation||1;var o=Number(e.maxImgSize);!e.orientation&&n<o&i<o?e.imgs=e.img:(n>o&&(i=i/n*o,n=o),i>o&&(n=n/i*o,i=o),e.checkOrientationImage(t,e.orientation,n,i))})).catch((function(t){e.$emit("img-load","error"),e.$emit("img-load-error",t)}))},t.onerror=function(){e.$emit("imgLoad","error"),e.$emit("img-load","error"),e.$emit("img-load-error",error)},"data"!==this.img.substr(0,4)&&(t.crossOrigin=""),this.isIE){var n=new XMLHttpRequest;n.onload=function(){var e=URL.createObjectURL(this.response);t.src=e},n.open("GET",this.img,!0),n.responseType="blob",n.send()}else t.src=this.img},startMove:function(e){if(e.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=("clientX"in e?e.clientX:e.touches[0].clientX)-this.x,this.moveY=("clientY"in e?e.clientY:e.touches[0].clientY)-this.y,e.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),2==e.touches.length&&(this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("imgMoving",{moving:!0,axis:this.getImgAxis()}),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=e.offsetX?e.offsetX:e.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=e.offsetY?e.offsetY:e.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale:function(e){var t=this;e.preventDefault();var n=this.scale,i=this.touches[0].clientX,r=this.touches[0].clientY,o=e.touches[0].clientX,s=e.touches[0].clientY,a=this.touches[1].clientX,h=this.touches[1].clientY,c=e.touches[1].clientX,p=e.touches[1].clientY,l=Math.sqrt(Math.pow(i-a,2)+Math.pow(r-h,2)),u=Math.sqrt(Math.pow(o-c,2)+Math.pow(s-p,2))-l,d=1,f=(d=(d=d/this.trueWidth>d/this.trueHeight?d/this.trueHeight:d/this.trueWidth)>.1?.1:d)*u;if(!this.touchNow){if(this.touchNow=!0,u>0?n+=Math.abs(f):u<0&&n>Math.abs(f)&&(n-=Math.abs(f)),this.touches=e.touches,setTimeout((function(){t.touchNow=!1}),8),!this.checkoutImgAxis(this.x,this.y,n))return!1;this.scale=n}},cancelTouchScale:function(e){window.removeEventListener("touchmove",this.touchScale)},moveImg:function(e){var t=this;if(e.preventDefault(),e.touches&&2===e.touches.length)return this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;var n,i,r="clientX"in e?e.clientX:e.touches[0].clientX,o="clientY"in e?e.clientY:e.touches[0].clientY;n=r-this.moveX,i=o-this.moveY,this.$nextTick((function(){if(t.centerBox){var e,r,o,s,a=t.getImgAxis(n,i,t.scale),h=t.getCropAxis(),c=t.trueHeight*t.scale,p=t.trueWidth*t.scale;switch(t.rotate){case 1:case-1:case 3:case-3:e=t.cropOffsertX-t.trueWidth*(1-t.scale)/2+(c-p)/2,r=t.cropOffsertY-t.trueHeight*(1-t.scale)/2+(p-c)/2,o=e-c+t.cropW,s=r-p+t.cropH;break;default:e=t.cropOffsertX-t.trueWidth*(1-t.scale)/2,r=t.cropOffsertY-t.trueHeight*(1-t.scale)/2,o=e-p+t.cropW,s=r-c+t.cropH}a.x1>=h.x1&&(n=e),a.y1>=h.y1&&(i=r),a.x2<=h.x2&&(n=o),a.y2<=h.y2&&(i=s)}t.x=n,t.y=i,t.$emit("imgMoving",{moving:!0,axis:t.getImgAxis()}),t.$emit("img-moving",{moving:!0,axis:t.getImgAxis()})}))},leaveImg:function(e){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("imgMoving",{moving:!1,axis:this.getImgAxis()}),this.$emit("img-moving",{moving:!1,axis:this.getImgAxis()})},scaleImg:function(){this.canScale&&window.addEventListener(this.support,this.changeSize,this.passive)},cancelScale:function(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize:function(e){var t=this;e.preventDefault();var n=this.scale,i=e.deltaY||e.wheelDelta;i=navigator.userAgent.indexOf("Firefox")>0?30*i:i,this.isIE&&(i=-i);var r=this.coe,o=(r=r/this.trueWidth>r/this.trueHeight?r/this.trueHeight:r/this.trueWidth)*i;o<0?n+=Math.abs(o):n>Math.abs(o)&&(n-=Math.abs(o));var s=o<0?"add":"reduce";if(s!==this.coeStatus&&(this.coeStatus=s,this.coe=.2),this.scaling||(this.scalingSet=setTimeout((function(){t.scaling=!1,t.coe=t.coe+=.01}),50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,n))return!1;this.scale=n},changeScale:function(e){var t=this.scale;e=e||1;var n=20;if((e*=n=n/this.trueWidth>n/this.trueHeight?n/this.trueHeight:n/this.trueWidth)>0?t+=Math.abs(e):t>Math.abs(e)&&(t-=Math.abs(e)),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},createCrop:function(e){var t=this;e.preventDefault();var n="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,i="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;this.$nextTick((function(){var e=n-t.cropX,r=i-t.cropY;if(e>0?(t.cropW=e+t.cropChangeX>t.w?t.w-t.cropChangeX:e,t.cropOffsertX=t.cropChangeX):(t.cropW=t.w-t.cropChangeX+Math.abs(e)>t.w?t.cropChangeX:Math.abs(e),t.cropOffsertX=t.cropChangeX+e>0?t.cropChangeX+e:0),t.fixed){var o=t.cropW/t.fixedNumber[0]*t.fixedNumber[1];o+t.cropOffsertY>t.h?(t.cropH=t.h-t.cropOffsertY,t.cropW=t.cropH/t.fixedNumber[1]*t.fixedNumber[0],t.cropOffsertX=e>0?t.cropChangeX:t.cropChangeX-t.cropW):t.cropH=o,t.cropOffsertY=t.cropOffsertY}else r>0?(t.cropH=r+t.cropChangeY>t.h?t.h-t.cropChangeY:r,t.cropOffsertY=t.cropChangeY):(t.cropH=t.h-t.cropChangeY+Math.abs(r)>t.h?t.cropChangeY:Math.abs(r),t.cropOffsertY=t.cropChangeY+r>0?t.cropChangeY+r:0)}))},changeCropSize:function(e,t,n,i,r){e.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=t,this.canChangeY=n,this.changeCropTypeX=i,this.changeCropTypeY=r,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0),this.$emit("changeCropSize",{width:this.cropW,height:this.cropH}),this.$emit("change-crop-size",{width:this.cropW,height:this.cropH})},changeCropNow:function(e){var t=this;e.preventDefault();var n="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,i="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0,o=this.w,s=this.h,a=0,h=0;if(this.centerBox){var c=this.getImgAxis(),p=c.x2,l=c.y2;a=c.x1>0?c.x1:0,h=c.y1>0?c.y1:0,o>p&&(o=p),s>l&&(s=l)}var u=r(this.checkCropLimitSize(),2),d=u[0],f=u[1];this.$nextTick((function(){var e=n-t.cropX,r=i-t.cropY;if(t.canChangeX&&(1===t.changeCropTypeX?t.cropOldW-e<d?(t.cropW=d,t.cropOffsertX=t.cropOldW+t.cropChangeX-a-d):t.cropOldW-e>0?(t.cropW=o-t.cropChangeX-e<=o-a?t.cropOldW-e:t.cropOldW+t.cropChangeX-a,t.cropOffsertX=o-t.cropChangeX-e<=o-a?t.cropChangeX+e:a):(t.cropW=Math.abs(e)+t.cropChangeX<=o?Math.abs(e)-t.cropOldW:o-t.cropOldW-t.cropChangeX,t.cropOffsertX=t.cropChangeX+t.cropOldW):2===t.changeCropTypeX&&(t.cropOldW+e<d?t.cropW=d:t.cropOldW+e>0?(t.cropW=t.cropOldW+e+t.cropOffsertX<=o?t.cropOldW+e:o-t.cropOffsertX,t.cropOffsertX=t.cropChangeX):(t.cropW=o-t.cropChangeX+Math.abs(e+t.cropOldW)<=o-a?Math.abs(e+t.cropOldW):t.cropChangeX-a,t.cropOffsertX=o-t.cropChangeX+Math.abs(e+t.cropOldW)<=o-a?t.cropChangeX-Math.abs(e+t.cropOldW):a))),t.canChangeY&&(1===t.changeCropTypeY?t.cropOldH-r<f?(t.cropH=f,t.cropOffsertY=t.cropOldH+t.cropChangeY-h-f):t.cropOldH-r>0?(t.cropH=s-t.cropChangeY-r<=s-h?t.cropOldH-r:t.cropOldH+t.cropChangeY-h,t.cropOffsertY=s-t.cropChangeY-r<=s-h?t.cropChangeY+r:h):(t.cropH=Math.abs(r)+t.cropChangeY<=s?Math.abs(r)-t.cropOldH:s-t.cropOldH-t.cropChangeY,t.cropOffsertY=t.cropChangeY+t.cropOldH):2===t.changeCropTypeY&&(t.cropOldH+r<f?t.cropH=f:t.cropOldH+r>0?(t.cropH=t.cropOldH+r+t.cropOffsertY<=s?t.cropOldH+r:s-t.cropOffsertY,t.cropOffsertY=t.cropChangeY):(t.cropH=s-t.cropChangeY+Math.abs(r+t.cropOldH)<=s-h?Math.abs(r+t.cropOldH):t.cropChangeY-h,t.cropOffsertY=s-t.cropChangeY+Math.abs(r+t.cropOldH)<=s-h?t.cropChangeY-Math.abs(r+t.cropOldH):h))),t.canChangeX&&t.fixed){var c=t.cropW/t.fixedNumber[0]*t.fixedNumber[1];c<f?(t.cropH=f,t.cropW=t.fixedNumber[0]*f/t.fixedNumber[1],1===t.changeCropTypeX&&(t.cropOffsertX=t.cropChangeX+(t.cropOldW-t.cropW))):c+t.cropOffsertY>s?(t.cropH=s-t.cropOffsertY,t.cropW=t.cropH/t.fixedNumber[1]*t.fixedNumber[0],1===t.changeCropTypeX&&(t.cropOffsertX=t.cropChangeX+(t.cropOldW-t.cropW))):t.cropH=c}if(t.canChangeY&&t.fixed){var p=t.cropH/t.fixedNumber[1]*t.fixedNumber[0];p<d?(t.cropW=d,t.cropH=t.fixedNumber[1]*d/t.fixedNumber[0]):p+t.cropOffsertX>o?(t.cropW=o-t.cropOffsertX,t.cropH=t.cropW/t.fixedNumber[0]*t.fixedNumber[1]):t.cropW=p}t.$emit("cropSizing",{cropW:t.cropW,cropH:t.cropH}),t.$emit("crop-sizing",{cropW:t.cropW,cropH:t.cropH})}))},checkCropLimitSize:function(){this.cropW,this.cropH;var e=this.limitMinSize,t=new Array;return t=Array.isArray(e)?e:[e,e],[parseFloat(t[0]),parseFloat(t[1])]},changeCropEnd:function(e){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},calculateSize:function(e,t,n,i,r,o){var s=e/t,a=r,h=o;return a<n&&(a=n,h=Math.ceil(a/s)),h<i&&(h=i,(a=Math.ceil(h*s))<n&&(a=n,h=Math.ceil(a/s))),a<r&&(a=r,h=Math.ceil(a/s)),h<o&&(h=o,a=Math.ceil(h*s)),{width:a,height:h}},endCrop:function(){0===this.cropW&&0===this.cropH&&(this.cropping=!1);var e=r(this.checkCropLimitSize(),2),t=e[0],n=e[1],i=this.fixed?this.calculateSize(this.fixedNumber[0],this.fixedNumber[1],t,n,this.cropW,this.cropH):{width:t,height:n},o=i.width,s=i.height;o>this.cropW&&(this.cropW=o,this.cropOffsertX+o>this.w&&(this.cropOffsertX=this.w-o)),s>this.cropH&&(this.cropH=s,this.cropOffsertY+s>this.h&&(this.cropOffsertY=this.h-s)),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop:function(){this.crop=!0},stopCrop:function(){this.crop=!1},clearCrop:function(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove:function(e){if(e.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(e),!1;if(e.touches&&2===e.touches.length)return this.crop=!1,this.startMove(e),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);var t,n,i="clientX"in e?e.clientX:e.touches[0].clientX,r="clientY"in e?e.clientY:e.touches[0].clientY;t=i-this.cropOffsertX,n=r-this.cropOffsertY,this.cropX=t,this.cropY=n,this.$emit("cropMoving",{moving:!0,axis:this.getCropAxis()}),this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})},moveCrop:function(e,t){var n=this,i=0,r=0;e&&(e.preventDefault(),i="clientX"in e?e.clientX:e.touches[0].clientX,r="clientY"in e?e.clientY:e.touches[0].clientY),this.$nextTick((function(){var e,o,s=i-n.cropX,a=r-n.cropY;if(t&&(s=n.cropOffsertX,a=n.cropOffsertY),e=s<=0?0:s+n.cropW>n.w?n.w-n.cropW:s,o=a<=0?0:a+n.cropH>n.h?n.h-n.cropH:a,n.centerBox){var h=n.getImgAxis();e<=h.x1&&(e=h.x1),e+n.cropW>h.x2&&(e=h.x2-n.cropW),o<=h.y1&&(o=h.y1),o+n.cropH>h.y2&&(o=h.y2-n.cropH)}n.cropOffsertX=e,n.cropOffsertY=o,n.$emit("cropMoving",{moving:!0,axis:n.getCropAxis()}),n.$emit("crop-moving",{moving:!0,axis:n.getCropAxis()})}))},getImgAxis:function(e,t,n){e=e||this.x,t=t||this.y,n=n||this.scale;var i={x1:0,x2:0,y1:0,y2:0},r=this.trueWidth*n,o=this.trueHeight*n;switch(this.rotate){case 0:i.x1=e+this.trueWidth*(1-n)/2,i.x2=i.x1+this.trueWidth*n,i.y1=t+this.trueHeight*(1-n)/2,i.y2=i.y1+this.trueHeight*n;break;case 1:case-1:case 3:case-3:i.x1=e+this.trueWidth*(1-n)/2+(r-o)/2,i.x2=i.x1+this.trueHeight*n,i.y1=t+this.trueHeight*(1-n)/2+(o-r)/2,i.y2=i.y1+this.trueWidth*n;break;default:i.x1=e+this.trueWidth*(1-n)/2,i.x2=i.x1+this.trueWidth*n,i.y1=t+this.trueHeight*(1-n)/2,i.y2=i.y1+this.trueHeight*n}return i},getCropAxis:function(){var e={x1:0,x2:0,y1:0,y2:0};return e.x1=this.cropOffsertX,e.x2=e.x1+this.cropW,e.y1=this.cropOffsertY,e.y2=e.y1+this.cropH,e},leaveCrop:function(e){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("cropMoving",{moving:!1,axis:this.getCropAxis()}),this.$emit("crop-moving",{moving:!1,axis:this.getCropAxis()})},getCropChecked:function(e){var t=this,n=document.createElement("canvas"),i=n.getContext("2d"),r=new Image,o=this.rotate,s=this.trueWidth,a=this.trueHeight,h=this.cropOffsertX,c=this.cropOffsertY;r.onload=function(){if(0!==t.cropW){var p=1;t.high&!t.full&&(p=window.devicePixelRatio),1!==t.enlarge&!t.full&&(p=Math.abs(Number(t.enlarge)));var u=t.cropW*p,d=t.cropH*p,f=s*t.scale*p,g=a*t.scale*p,m=(t.x-h+t.trueWidth*(1-t.scale)/2)*p,A=(t.y-c+t.trueHeight*(1-t.scale)/2)*p;switch(l(u,d),i.save(),o){case 0:t.full?(l(u/t.scale,d/t.scale),i.drawImage(r,m/t.scale,A/t.scale,f/t.scale,g/t.scale)):i.drawImage(r,m,A,f,g);break;case 1:case-3:t.full?(l(u/t.scale,d/t.scale),m=m/t.scale+(f/t.scale-g/t.scale)/2,A=A/t.scale+(g/t.scale-f/t.scale)/2,i.rotate(90*o*Math.PI/180),i.drawImage(r,A,-m-g/t.scale,f/t.scale,g/t.scale)):(m+=(f-g)/2,A+=(g-f)/2,i.rotate(90*o*Math.PI/180),i.drawImage(r,A,-m-g,f,g));break;case 2:case-2:t.full?(l(u/t.scale,d/t.scale),i.rotate(90*o*Math.PI/180),m/=t.scale,A/=t.scale,i.drawImage(r,-m-f/t.scale,-A-g/t.scale,f/t.scale,g/t.scale)):(i.rotate(90*o*Math.PI/180),i.drawImage(r,-m-f,-A-g,f,g));break;case 3:case-1:t.full?(l(u/t.scale,d/t.scale),m=m/t.scale+(f/t.scale-g/t.scale)/2,A=A/t.scale+(g/t.scale-f/t.scale)/2,i.rotate(90*o*Math.PI/180),i.drawImage(r,-A-f/t.scale,m,f/t.scale,g/t.scale)):(m+=(f-g)/2,A+=(g-f)/2,i.rotate(90*o*Math.PI/180),i.drawImage(r,-A-f,m,f,g));break;default:t.full?(l(u/t.scale,d/t.scale),i.drawImage(r,m/t.scale,A/t.scale,f/t.scale,g/t.scale)):i.drawImage(r,m,A,f,g)}i.restore()}else{var v=s*t.scale,w=a*t.scale;switch(i.save(),o){case 0:l(v,w),i.drawImage(r,0,0,v,w);break;case 1:case-3:l(w,v),i.rotate(90*o*Math.PI/180),i.drawImage(r,0,-w,v,w);break;case 2:case-2:l(v,w),i.rotate(90*o*Math.PI/180),i.drawImage(r,-v,-w,v,w);break;case 3:case-1:l(w,v),i.rotate(90*o*Math.PI/180),i.drawImage(r,-v,0,v,w);break;default:l(v,w),i.drawImage(r,0,0,v,w)}i.restore()}e(n)},"data"!==this.img.substr(0,4)&&(r.crossOrigin="Anonymous"),r.src=this.imgs;var p=this.fillColor;function l(e,t){n.width=Math.round(e),n.height=Math.round(t),p&&(i.fillStyle=p,i.fillRect(0,0,n.width,n.height))}},getCropData:function(e){var t=this;this.getCropChecked((function(n){e(n.toDataURL("image/"+t.outputType,t.outputSize))}))},getCropBlob:function(e){var t=this;this.getCropChecked((function(n){n.toBlob((function(t){return e(t)}),"image/"+t.outputType,t.outputSize)}))},showPreview:function(){var e=this;if(!this.isCanShow)return!1;this.isCanShow=!1,setTimeout((function(){e.isCanShow=!0}),16);var t=this.cropW,n=this.cropH,i=this.scale,r={};r.div={width:"".concat(t,"px"),height:"".concat(n,"px")};var o=(this.x-this.cropOffsertX)/i,s=(this.y-this.cropOffsertY)/i;r.w=t,r.h=n,r.url=this.imgs,r.img={width:"".concat(this.trueWidth,"px"),height:"".concat(this.trueHeight,"px"),transform:"scale(".concat(i,")translate3d(").concat(o,"px, ").concat(s,"px, ").concat(0,"px)rotateZ(").concat(90*this.rotate,"deg)")},r.html='\n      <div class="show-preview" style="width: '.concat(r.w,"px; height: ").concat(r.h,'px; overflow: hidden">\n        <div style="width: ').concat(t,"px; height: ").concat(n,'px">\n          <img src=').concat(r.url,' style="width: ').concat(this.trueWidth,"px; height: ").concat(this.trueHeight,"px; transform:\n          scale(").concat(i,")translate3d(").concat(o,"px, ").concat(s,"px, ").concat(0,"px)rotateZ(").concat(90*this.rotate,'deg)">\n        </div>\n      </div>'),this.$emit("realTime",r),this.$emit("real-time",r)},reload:function(){var e=this,t=new Image;t.onload=function(){e.w=parseFloat(window.getComputedStyle(e.$refs.cropper).width),e.h=parseFloat(window.getComputedStyle(e.$refs.cropper).height),e.trueWidth=t.width,e.trueHeight=t.height,e.original?e.scale=1:e.scale=e.checkedMode(),e.$nextTick((function(){e.x=-(e.trueWidth-e.trueWidth*e.scale)/2+(e.w-e.trueWidth*e.scale)/2,e.y=-(e.trueHeight-e.trueHeight*e.scale)/2+(e.h-e.trueHeight*e.scale)/2,e.loading=!1,e.autoCrop&&e.goAutoCrop(),e.$emit("img-load","success"),e.$emit("imgLoad","success"),setTimeout((function(){e.showPreview()}),20)}))},t.onerror=function(){e.$emit("imgLoad","error"),e.$emit("img-load","error")},t.src=this.imgs},checkedMode:function(){var e=1,t=(this.trueWidth,this.trueHeight),n=this.mode.split(" ");switch(n[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":(t*=e=this.w/this.trueWidth)<this.h&&(e=(t=this.h)/this.trueHeight);break;default:try{var i=n[0];if(-1!==i.search("px")){i=i.replace("px","");var r=parseFloat(i)/this.trueWidth,o=1,s=n[1];-1!==s.search("px")&&(s=s.replace("px",""),o=(t=parseFloat(s))/this.trueHeight),e=Math.min(r,o)}if(-1!==i.search("%")&&(i=i.replace("%",""),e=parseFloat(i)/100*this.w/this.trueWidth),2===n.length&&"auto"===i){var a=n[1];-1!==a.search("px")&&(a=a.replace("px",""),e=(t=parseFloat(a))/this.trueHeight),-1!==a.search("%")&&(a=a.replace("%",""),e=(t=parseFloat(a)/100*this.h)/this.trueHeight)}}catch(t){e=1}}return e},goAutoCrop:function(e,t){if(""!==this.imgs&&null!==this.imgs){this.clearCrop(),this.cropping=!0;var n=this.w,i=this.h;if(this.centerBox){var r=Math.abs(this.rotate)%2>0,o=(r?this.trueHeight:this.trueWidth)*this.scale,s=(r?this.trueWidth:this.trueHeight)*this.scale;n=o<n?o:n,i=s<i?s:i}var a=e||parseFloat(this.autoCropWidth),h=t||parseFloat(this.autoCropHeight);0!==a&&0!==h||(a=.8*n,h=.8*i),a=a>n?n:a,h=h>i?i:h,this.fixed&&(h=a/this.fixedNumber[0]*this.fixedNumber[1]),h>this.h&&(a=(h=this.h)/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(a,h)}},changeCrop:function(e,t){var n=this;if(this.centerBox){var i=this.getImgAxis();e>i.x2-i.x1&&(t=(e=i.x2-i.x1)/this.fixedNumber[0]*this.fixedNumber[1]),t>i.y2-i.y1&&(e=(t=i.y2-i.y1)/this.fixedNumber[1]*this.fixedNumber[0])}this.cropW=e,this.cropH=t,this.checkCropLimitSize(),this.$nextTick((function(){n.cropOffsertX=(n.w-n.cropW)/2,n.cropOffsertY=(n.h-n.cropH)/2,n.centerBox&&n.moveCrop(null,!0)}))},refresh:function(){var e=this;this.img,this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.clearCrop(),this.$nextTick((function(){e.checkedImg()}))},rotateLeft:function(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight:function(){this.rotate=this.rotate>=3?0:this.rotate+1},rotateClear:function(){this.rotate=0},checkoutImgAxis:function(e,t,n){e=e||this.x,t=t||this.y,n=n||this.scale;var i=!0;if(this.centerBox){var r=this.getImgAxis(e,t,n),o=this.getCropAxis();r.x1>=o.x1&&(i=!1),r.x2<=o.x2&&(i=!1),r.y1>=o.y1&&(i=!1),r.y2<=o.y2&&(i=!1),i||this.changeImgScale(r,o,n)}return i},changeImgScale:function(e,t,n){var i=this.trueWidth,r=this.trueHeight,o=i*n,s=r*n;if(o>=this.cropW&&s>=this.cropH)this.scale=n;else{var a=this.cropW/i,h=this.cropH/r,c=this.cropH<=r*a?a:h;this.scale=c,o=i*c,s=r*c}this.imgIsQqualCrop||(e.x1>=t.x1&&(this.isRotateRightOrLeft?this.x=t.x1-(i-o)/2-(o-s)/2:this.x=t.x1-(i-o)/2),e.x2<=t.x2&&(this.isRotateRightOrLeft?this.x=t.x1-(i-o)/2-(o-s)/2-s+this.cropW:this.x=t.x2-(i-o)/2-o),e.y1>=t.y1&&(this.isRotateRightOrLeft?this.y=t.y1-(r-s)/2-(s-o)/2:this.y=t.y1-(r-s)/2),e.y2<=t.y2&&(this.isRotateRightOrLeft?this.y=t.y2-(r-s)/2-(s-o)/2-o:this.y=t.y2-(r-s)/2-s)),(o<this.cropW||s<this.cropH)&&(this.imgIsQqualCrop=!0)}},mounted:function(){this.support="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";var e=this,t=navigator.userAgent;this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,n,i){for(var r=atob(this.toDataURL(n,i).split(",")[1]),o=r.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=r.charCodeAt(a);t(new Blob([s],{type:e.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},destroyed:function(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.cancelScale()}};var h=n(72),c=n.n(h),p=n(825),l=n.n(p),u=n(659),d=n.n(u),f=n(56),g=n.n(f),m=n(540),A=n.n(m),v=n(113),w=n.n(v),x=n(750),C={};C.styleTagTransform=w(),C.setAttributes=g(),C.insert=d().bind(null,"head"),C.domAPI=l(),C.insertStyleElement=A(),c()(x.A,C),x.A&&x.A.locals&&x.A.locals;var b=function(e,t,n,i,r,o,s,a){var h,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=[],c._compiled=!0),o&&(c._scopeId="data-v-"+o),h)if(c.functional){c._injectStyles=h;var p=c.render;c.render=function(e,t){return h.call(t),p(e,t)}}else{var l=c.beforeCreate;c.beforeCreate=l?[].concat(l,h):[h]}return{exports:e,options:c}}(a,e,0,0,0,"01ee97ad");const y=b.exports;var H=function(e){e.component("VueCropper",y)};"undefined"!=typeof window&&window.Vue&&H(window.Vue);const W={version:"0.6.5",install:H,VueCropper:y,vueCropper:y}})(),i})())},cc439:function(e,t,n){"use strict";n("dcd5"),Object.defineProperty(t,"__esModule",{value:!0}),t.CROPPER_PROPS=void 0,n("3fa1"),n("1469");t.CROPPER_PROPS={width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"100%"},cutWidth:{type:[String,Number],default:"50%"},cutHeight:{type:[String,Number],default:0},minWidth:{type:Number,default:50},minHeight:{type:Number,default:50},center:{type:Boolean,default:!0},src:String,disableScale:Boolean,disableRotate:{type:Boolean,default:!1},disableTranslate:Boolean,disableCtrl:Boolean,boundDetect:{type:Boolean,default:!1},freeBoundDetect:Boolean,keepRatio:Boolean,disablePreview:{type:Boolean,default:!1},showCtrlBorder:Boolean,resetCut:Boolean,fit:{type:Boolean,default:!0},imageCenter:Boolean,maxZoom:{type:Number,default:10},minZoom:{type:Number,default:1},angle:{type:Number,default:0},zoom:{type:Number,default:1},offset:{type:Array,default:function(){return[0,0]}},background:{type:String,default:"#000"},canvasBackground:{type:String,default:"#fff"},canvasZoom:{type:Number,default:1},fileType:{type:String,default:"png",validator:function(e){return["png","jpg"].includes(e)}},quality:{type:Number,default:1},maskType:{type:String,default:"shadow"},circleView:Boolean}},d298:function(e,t,n){"use strict";n.r(t);var i=n("da70"),r=n("970e");for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);n("466f");var s,a=n("921e"),h=Object(a["a"])(r["default"],i["b"],i["c"],!1,null,"7e8a3451",null,!1,i["a"],s);t["default"]=h.exports},da70:function(e,t,n){"use strict";var i;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"demo-wrap"},[n("PressButton",{attrs:{type:"primary",block:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.selectImg.apply(void 0,arguments)}}},[e._v("上传图片")]),n("PressCropper",{attrs:{show:e.show,src:e.src,zoom:1,angle:0,"cut-width":"100%","bound-detect":!0,"disable-preview":!0,"disable-rotate":!0,"canvas-background":"black","is-e-sport":e.isESport,"h5-option":e.h5Option},on:{cropped:function(t){arguments[0]=t=e.$handleEvent(t),e.cropped.apply(void 0,arguments)},afterDraw:function(t){arguments[0]=t=e.$handleEvent(t),e.afterDraw.apply(void 0,arguments)},beforeDraw:function(t){arguments[0]=t=e.$handleEvent(t),e.beforeDraw.apply(void 0,arguments)},cancel:function(t){arguments[0]=t=e.$handleEvent(t),e.cancel.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)}}}),e.parsedImage?n("PressImage",{attrs:{src:e.parsedImage,mode:"aspectFit","transition-style":"margin: 20px auto;display: flex;justify-content: center;","custom-style":"border: 1px solid #eee;"}}):e._e()],1)},o=[]},fe1b:function(e,t,n){var i=n("adb3");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var r=n("5a15").default;r("d7137e1a",i,!0,{sourceMap:!1,shadowMode:!1})}}]);