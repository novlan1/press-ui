(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{618:function(a,s,e){"use strict";e.r(s);var t=e(37),_=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"贡献指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#贡献指南"}},[a._v("#")]),a._v(" 贡献指南")]),a._v(" "),s("h2",{attrs:{id:"_1-目录结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-目录结构"}},[a._v("#")]),a._v(" 1. 目录结构")]),a._v(" "),s("p",[a._v("项目结构如下：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("- docs            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 文档地址")]),a._v("\n- plugin          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# [demo]工程用到的插件")]),a._v("\n- script          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 脚本")]),a._v("\n- tests           "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 测试用例")]),a._v("\n- src\n  - common        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# [demo]公共内容")]),a._v("\n  - packages      "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 对外发布的包内容")]),a._v("\n  - pages         "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# [demo]页面内容")]),a._v("\n  - static        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# [demo]静态内容")]),a._v("\n  - App.vue       "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# [demo]应用入口")]),a._v("\n  - main.js\n  - pages.json\n")])])]),s("p",[a._v("组件库除了组件外，还有文档、示例、工程化配置等部分。为了维护起来方便，将示例、文档、组件都放在一个文件夹里，所以一个标准的组件目录如下：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("- press-button\n  - demo-helper/        "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 非必需，组件示例相关数据、方法")]),a._v("\n  - helper/             "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 非必需，业务层处理数据的相关方法，可能引入 t-comm 第三方模块")]),a._v("\n  - demo.vue            "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 组件示例")]),a._v("\n  - press-button.vue    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 组件")]),a._v("\n  - README.md           "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 组件中文文档")]),a._v("\n  - README.en-US.md     "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 组件英文文档")]),a._v("\n")])])]),s("p",[s("code",[a._v("src/packages")]),a._v("下就是由这些组件文件夹和一些公共文件构成。")]),a._v(" "),s("p",[a._v("上面的组织结构并不能直接用，还需要把"),s("code",[a._v("README.md")]),a._v("移动到"),s("code",[a._v("docs")]),a._v("中，把"),s("code",[a._v("demo.vue")]),a._v("移动到"),s("code",[a._v("src/pages")]),a._v("中。开发时会监听这些文件变动，发生变动后就把它们拷贝到需要的位置上。")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/6/own_mike_160511d777e5015f01.gif",width:"700"}})]),a._v(" "),s("h2",{attrs:{id:"_2-开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-开发"}},[a._v("#")]),a._v(" 2. 开发")]),a._v(" "),s("p",[a._v("首先要执行如下命令，进行组件的派发：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run init\n")])])]),s("h3",{attrs:{id:"_2-1-组件开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-组件开发"}},[a._v("#")]),a._v(" 2.1. 组件开发")]),a._v(" "),s("p",[a._v("对于H5、微信小程序、QQ小程序有不同的启动命令：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run dev\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# h5")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run dev:mp-weixin\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 微信小程序")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run dev:mp-qq\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# qq小程序")]),a._v("\n")])])]),s("h3",{attrs:{id:"_2-2-新增组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-新增组件"}},[a._v("#")]),a._v(" 2.2. 新增组件")]),a._v(" "),s("p",[a._v("执行以下命令：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run new:comp\n")])])]),s("p",[a._v("然后交互式的输入组件英文名、中文名等内容即可。")]),a._v(" "),s("h3",{attrs:{id:"_2-3-文档开发"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-文档开发"}},[a._v("#")]),a._v(" 2.3. 文档开发")]),a._v(" "),s("p",[a._v("文档开发命令：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run docs:dev\n")])])]),s("h3",{attrs:{id:"_2-4-文档、示例部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-文档、示例部署"}},[a._v("#")]),a._v(" 2.4. 文档、示例部署")]),a._v(" "),s("p",[s("code",[a._v("Press UI")]),a._v("接入了CI，代码推送后会自动构建，并部署H5、微信小程序、QQ小程序三端示例及文档。")]),a._v(" "),s("h3",{attrs:{id:"_2-5-辅助方法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-辅助方法"}},[a._v("#")]),a._v(" 2.5. 辅助方法")]),a._v(" "),s("p",[a._v("Press UI 内部提供了一些提效工具，包括：")]),a._v(" "),s("ul",[s("li",[a._v("提取 "),s("code",[a._v("props")]),a._v("，可用于文档")]),a._v(" "),s("li",[a._v("提取 "),s("code",[a._v("event")]),a._v("，可用于文档")]),a._v(" "),s("li",[a._v("提取 "),s("code",[a._v("class")]),a._v("，可用于 BEM 改造中的映射表")]),a._v(" "),s("li",[a._v("CSS 单位转化，"),s("code",[a._v("rem")]),a._v(" => "),s("code",[a._v("px")])]),a._v(" "),s("li",[a._v("自动添加、修正组件的 "),s("code",[a._v("name")]),a._v(" 属性")]),a._v(" "),s("li",[a._v("自动添加组件的 "),s("code",[a._v("emits")]),a._v(" 属性，Vue3 需要")]),a._v(" "),s("li",[a._v("活动组件增加隐藏 @TIP_STYLE_NAME 样式")]),a._v(" "),s("li",[a._v("活动组件进行 CSS 替换")])]),a._v(" "),s("p",[a._v("使用方法如下：")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 提取 props")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# npm run extract:props [componentPath]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run extract:props src/packages/press-act-input-phone-dialog/press-act-input-phone-dialog.vue\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 提取 event")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# npm run extract:event [componentPath]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run extract:event src/packages/press-act-input-phone-dialog/press-act-input-phone-dialog.vue\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 提取 class")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# npm run extract:class [componentPath]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run extract:class src/packages/press-hor-owner-index/press-hor-owner-index.vue\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# rem 转 px")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# npm run rem:px [componentPath]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run rem:px src/packages/press-message-board/press-message-board-input.vue\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 添加、修正 name 属性")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run add:name\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 添加 emits 属性")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run add:emits\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 活动组件增加隐藏 TIP_STYLE_NAME 样式")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run act:hide:tip\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 活动组件进行 CSS 替换")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" run act:replace:class\n")])])]),s("h2",{attrs:{id:"_3-开发规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-开发规范"}},[a._v("#")]),a._v(" 3. 开发规范")]),a._v(" "),s("h3",{attrs:{id:"_3-1-代码规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-代码规范"}},[a._v("#")]),a._v(" 3.1. 代码规范")]),a._v(" "),s("p",[a._v("需符合公司代码规范。")]),a._v(" "),s("h3",{attrs:{id:"_3-2-提交规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-提交规范"}},[a._v("#")]),a._v(" 3.2. 提交规范")]),a._v(" "),s("p",[a._v("推荐"),s("a",{attrs:{href:"https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/conventional-changelog-angular",target:"_blank",rel:"noopener noreferrer"}},[a._v("Angular 规范"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"_3-3-命名规范"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-命名规范"}},[a._v("#")]),a._v(" 3.3. 命名规范")]),a._v(" "),s("ul",[s("li",[a._v("导出对象、类、组件，用大驼峰命名法，首字母大写")]),a._v(" "),s("li",[a._v("导出方法，用小驼峰命名法，首字母小写，如"),s("code",[a._v("loader")]),a._v("、"),s("code",[a._v("post")]),a._v("、"),s("code",[a._v("appBase")]),a._v("、"),s("code",[a._v("getAreaCode")]),a._v("等")]),a._v(" "),s("li",[a._v("文件名用小写+中划线，比如"),s("code",[a._v("message-dialog")]),a._v("，不能用"),s("code",[a._v("messageDialog")])])]),a._v(" "),s("h3",{attrs:{id:"_3-4-其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-其他"}},[a._v("#")]),a._v(" 3.4. 其他")]),a._v(" "),s("p",[a._v("对外API需简单、易记忆，比如"),s("code",[a._v("change")]),a._v("、"),s("code",[a._v("list")]),a._v("，最好一个单词组成，并且不能简写，与业界流行组件库对齐。")]),a._v(" "),s("p",[a._v("不能在组件内部"),s("code",[a._v("console.log")]),a._v("。")]),a._v(" "),s("p",[a._v("类名需符合"),s("a",{attrs:{href:"https://getbem.com/",target:"_blank",rel:"noopener noreferrer"}},[a._v("BEM"),s("OutboundLink")],1),a._v("规范，并以"),s("code",[a._v("press")]),a._v("为前缀。")]),a._v(" "),s("h2",{attrs:{id:"_4-细节"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-细节"}},[a._v("#")]),a._v(" 4. 细节")]),a._v(" "),s("h3",{attrs:{id:"_4-1-rem单位"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-rem单位"}},[a._v("#")]),a._v(" 4.1. rem单位")]),a._v(" "),s("p",[a._v("目前有的组件使用的单位是"),s("code",[a._v("rem")])]),a._v(" "),s("ul",[s("li",[a._v("优势：h5端适配更好，更合适")]),a._v(" "),s("li",[a._v("劣势：在小程序等其他端需要额外的插件来转换")])]),a._v(" "),s("p",[s("code",[a._v("Press UI")]),a._v("并不强制单位，只要组件内部统一即可。")]),a._v(" "),s("h3",{attrs:{id:"_4-2-准入条件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-准入条件"}},[a._v("#")]),a._v(" 4.2. 准入条件")]),a._v(" "),s("p",[s("code",[a._v("Press UI")]),a._v("内的组件、逻辑需要有一定的通用性或复杂性，比如"),s("code",[a._v("button")]),a._v("、"),s("code",[a._v("input")]),a._v("、"),s("code",[a._v("area")]),a._v("、"),s("code",[a._v("message-detail")]),a._v("等组件通用型强，"),s("code",[a._v("schedule-tree")]),a._v("组件复杂度高。")]),a._v(" "),s("p",[a._v("宁缺毋滥，沉入的组件必须完成 BEM 改造，必须与业务充分解耦。")]),a._v(" "),s("blockquote",[s("p",[a._v("取乎其上，得乎其中，取乎其中，得乎其下，取乎其下，其无所得也。")])]),a._v(" "),s("p",[a._v("一开始就尽量把组件设计好，坚持高标准，避免后面返工。")]),a._v(" "),s("h3",{attrs:{id:"_4-3-脚本-优先"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-脚本-优先"}},[a._v("#")]),a._v(" 4.3. 脚本 优先")]),a._v(" "),s("p",[s("code",[a._v("js/ts")]),a._v("比"),s("code",[a._v("html")]),a._v("灵活，能写在"),s("code",[a._v("js/ts")]),a._v("中的，就不要在组件中判断，灵活意味着通用性强，在跨平台、横竖屏、技术栈迁移时候，"),s("code",[a._v("js/ts")]),a._v("都能够很方便的复用，但是组件就不行。")]),a._v(" "),s("h3",{attrs:{id:"_4-4-项目依赖关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-项目依赖关系"}},[a._v("#")]),a._v(" 4.4. 项目依赖关系")]),a._v(" "),s("p",[a._v("Press UI 底层依赖 "),s("code",[a._v("t-comm")]),a._v("、"),s("code",[a._v("plugin-light")]),a._v(" 等库。")]),a._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/6/own_mike_bbf5d09066a8980616.gif",width:"500"}}),a._v(" "),s("h3",{attrs:{id:"_4-5-适配多平台、多场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-适配多平台、多场景"}},[a._v("#")]),a._v(" 4.5. 适配多平台、多场景")]),a._v(" "),s("p",[a._v("Press UI 在兼容 Vue3 项目、非 "),s("code",[a._v("uni-app")]),a._v(" 环境、APP 环境时，采用的实现方式为，新建工程，并将 Press UI 组件库作为子仓库。")]),a._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/6/own_mike_ea7bcae60b32baedd8.gif",width:"500"}}),a._v(" "),s("h3",{attrs:{id:"_4-6-通用-灵活"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-6-通用-灵活"}},[a._v("#")]),a._v(" 4.6. 通用 & 灵活")]),a._v(" "),s("p",[a._v("下图是 H5、小程序、APP语法灵活度的对比。")]),a._v(" "),s("img",{attrs:{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/6/own_mike_fa30be46a942e03072.gif",width:"300"}}),a._v(" "),s("p",[a._v("Press UI 在编写跨端代码的时候，采用以下原则：")]),a._v(" "),s("ol",[s("li",[a._v("对齐短板，抹平差异，提供通用API")]),a._v(" "),s("li",[a._v("特殊场景下，条件编译，保持灵活性")])]),a._v(" "),s("p",[a._v("这里举一些 H5 环境下渐进式增强的例子：")]),a._v(" "),s("ol",[s("li",[a._v("函数式调用组件的时候，可以动态创建 Dom，无需预埋组件")]),a._v(" "),s("li",[s("code",[a._v("popover-plus")]),a._v(" 点击空白处会收起，即 "),s("code",[a._v("clickOutSide")])]),a._v(" "),s("li",[s("code",[a._v("list")]),a._v(" 支持自动检测外层 "),s("code",[a._v("scroller")]),a._v("，即支持任意父级的滚动")])]),a._v(" "),s("h3",{attrs:{id:"_4-7-i18n-实现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-7-i18n-实现"}},[a._v("#")]),a._v(" 4.7. i18n 实现")]),a._v(" "),s("p",[a._v("有几个核心函数：")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("setLang")]),a._v("，设置语言，包括初次设置和切换语言。如果携带了额外的语言包，则会调用 "),s("code",[a._v("local.use")]),a._v(" 或者 "),s("code",[a._v("local.add")]),a._v(" 进行注入")]),a._v(" "),s("li",[s("code",[a._v("initDemoI18n")]),a._v("，示例工程混入。包括 "),s("code",[a._v("onReady")]),a._v(" 时，根据当前组件名称设置 "),s("code",[a._v("navigationBarTitle")]),a._v("，以及提供 "),s("code",[a._v("t")]),a._v(" 方法，"),s("code",[a._v("t")]),a._v(" 方法会优先从 "),s("code",[a._v("this.$options.i18n")]),a._v(" 中取词汇表，否则调用 "),s("code",[a._v("locale/index")]),a._v(" 中的 "),s("code",[a._v("t")]),a._v(" 方法")]),a._v(" "),s("li",[s("code",[a._v("getLocale")]),a._v("，获取当前语言。如果是 "),s("code",[a._v("iframe")]),a._v(" 内，则从 "),s("code",[a._v("location.href")]),a._v(" 中获取，否则从 "),s("code",[a._v("storage")]),a._v(" 中获取")]),a._v(" "),s("li",[s("code",[a._v("toggleI18n")]),a._v("，切换语言。会先通过 "),s("code",[a._v("storage")]),a._v(" 注入新的语言标识。H5下会执行 "),s("code",[a._v("location.reload")]),a._v("，非 H5 下，会调用 "),s("code",[a._v("setLang")]),a._v(" 和 "),s("code",[a._v("uni.reLaunch")])])]),a._v(" "),s("p",[s("code",[a._v("App.vue")]),a._v(" 中会执行 "),s("code",[a._v("setLang")]),a._v("，进行示例工程所有语言包的注入，并进行缓存。切换语言时，也会调用 "),s("code",[a._v("setLang")]),a._v(" 无需传入语言包。")])])}),[],!1,null,null,null);s.default=_.exports}}]);